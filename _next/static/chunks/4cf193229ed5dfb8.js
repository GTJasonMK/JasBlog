(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55838,(e,t,n)=>{"use strict";var o=e.r(71645),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=o.useState,a=o.useEffect,l=o.useLayoutEffect,s=o.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(e){return!0}}var c="u"<typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),o=i({inst:{value:n,getSnapshot:t}}),r=o[0].inst,c=o[1];return l(function(){r.value=n,r.getSnapshot=t,d(r)&&c({inst:r})},[e,n,t]),a(function(){return d(r)&&c({inst:r}),e(function(){d(r)&&c({inst:r})})},[e]),s(n),n};n.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:c},2239,(e,t,n)=>{"use strict";t.exports=e.r(55838)},52822,(e,t,n)=>{"use strict";var o=e.r(71645),r=e.r(2239),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=r.useSyncExternalStore,l=o.useRef,s=o.useEffect,d=o.useMemo,c=o.useDebugValue;n.useSyncExternalStoreWithSelector=function(e,t,n,o,r){var u=l(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var f=a(e,(u=d(function(){function e(e){if(!s){if(s=!0,a=e,e=o(e),void 0!==r&&h.hasValue){var t=h.value;if(r(t,e))return l=t}return l=e}if(t=l,i(a,e))return t;var n=o(e);return void 0!==r&&r(t,n)?(a=e,t):(a=e,l=n)}var a,l,s=!1,d=void 0===n?null:n;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]},[t,n,o,r]))[0],u[1]);return s(function(){h.hasValue=!0,h.value=f},[f]),c(f),f}},30224,(e,t,n)=>{"use strict";t.exports=e.r(52822)},38841,e=>{"use strict";var t,n,o,r,i,a,l,s,d,c,u,h,f,g,p,m,x=e.i(18050),y=e.i(71645);function v(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)""!==(o=v(e[n]))&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}e.i(47167);var b=e.i(91889),w=e.i(23685),S=e.i(561),E=e.i(90273),M=e.i(36377);let C=e=>()=>e;function N(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:a,y:l,dx:s,dy:d,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:s,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:c}})}function k(e){return!e.ctrlKey&&!e.button}function j(){return this.parentNode}function P(e,t){return null==t?{x:e.x,y:e.y}:t}function I(){return navigator.maxTouchPoints||"ontouchstart"in this}function A(){var e,t,n,o,r=k,i=j,a=P,l=I,s={},d=(0,b.dispatch)("start","drag","end"),c=0,u=0;function h(e){e.on("mousedown.drag",f).filter(l).on("touchstart.drag",m).on("touchmove.drag",x,M.nonpassive).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(a,l){if(!o&&r.call(this,a,l)){var s=v(this,i.call(this,a,l),a,l,"mouse");s&&((0,w.select)(a.view).on("mousemove.drag",g,M.nonpassivecapture).on("mouseup.drag",p,M.nonpassivecapture),(0,E.default)(a.view),(0,M.nopropagation)(a),n=!1,e=a.clientX,t=a.clientY,s("start",a))}}function g(o){if((0,M.default)(o),!n){var r=o.clientX-e,i=o.clientY-t;n=r*r+i*i>u}s.mouse("drag",o)}function p(e){(0,w.select)(e.view).on("mousemove.drag mouseup.drag",null),(0,E.yesdrag)(e.view,n),(0,M.default)(e),s.mouse("end",e)}function m(e,t){if(r.call(this,e,t)){var n,o,a=e.changedTouches,l=i.call(this,e,t),s=a.length;for(n=0;n<s;++n)(o=v(this,l,e,t,a[n].identifier,a[n]))&&((0,M.nopropagation)(e),o("start",e,a[n]))}}function x(e){var t,n,o=e.changedTouches,r=o.length;for(t=0;t<r;++t)(n=s[o[t].identifier])&&((0,M.default)(e),n("drag",e,o[t]))}function y(e){var t,n,r=e.changedTouches,i=r.length;for(o&&clearTimeout(o),o=setTimeout(function(){o=null},500),t=0;t<i;++t)(n=s[r[t].identifier])&&((0,M.nopropagation)(e),n("end",e,r[t]))}function v(e,t,n,o,r,i){var l,u,f,g=d.copy(),p=(0,S.pointer)(i||n,t);if(null!=(f=a.call(e,new N("beforestart",{sourceEvent:n,target:h,identifier:r,active:c,x:p[0],y:p[1],dx:0,dy:0,dispatch:g}),o)))return l=f.x-p[0]||0,u=f.y-p[1]||0,function n(i,a,d){var m,x=p;switch(i){case"start":s[r]=n,m=c++;break;case"end":delete s[r],--c;case"drag":p=(0,S.pointer)(d||a,t),m=c}g.call(i,e,new N(i,{sourceEvent:a,subject:f,target:h,identifier:r,active:m,x:p[0]+l,y:p[1]+u,dx:p[0]-x[0],dy:p[1]-x[1],dispatch:g}),o)}}return h.filter=function(e){return arguments.length?(r="function"==typeof e?e:C(!!e),h):r},h.container=function(e){return arguments.length?(i="function"==typeof e?e:C(e),h):i},h.subject=function(e){return arguments.length?(a="function"==typeof e?e:C(e),h):a},h.touchable=function(e){return arguments.length?(l="function"==typeof e?e:C(!!e),h):l},h.on=function(){var e=d.on.apply(d,arguments);return e===d?h:e},h.clickDistance=function(e){return arguments.length?(u=(e*=1)*e,h):Math.sqrt(u)},h}N.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e},e.i(85664);var D=e.i(36755),D=D,$=e.i(7394),$=$,z=$,_=e.i(20713),L=e.i(44307);let R=[[-1/0,-1/0],[1/0,1/0]],O=["Enter"," ","Escape"],B={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};(t=d||(d={})).Strict="strict",t.Loose="loose",(n=c||(c={})).Free="free",n.Vertical="vertical",n.Horizontal="horizontal",(o=u||(u={})).Partial="partial",o.Full="full";let H={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};(r=h||(h={})).Bezier="default",r.Straight="straight",r.Step="step",r.SmoothStep="smoothstep",r.SimpleBezier="simplebezier",(i=f||(f={})).Arrow="arrow",i.ArrowClosed="arrowclosed",(a=g||(g={})).Left="left",a.Top="top",a.Right="right",a.Bottom="bottom";let T={[g.Left]:g.Right,[g.Right]:g.Left,[g.Top]:g.Bottom,[g.Bottom]:g.Top};function V(e){return null===e?null:e?"valid":"invalid"}let F=e=>"id"in e&&"source"in e&&"target"in e,Z=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),W=(e,t=[0,0])=>{let{width:n,height:o}=ev(e),r=e.origin??t,i=n*r[0],a=o*r[1];return{x:e.position.x-i,y:e.position.y-a}},X=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(e=>{(void 0===t.filter||t.filter(e))&&(n=en(n,ea(e)),o=!0)}),o?er(n):{x:0,y:0,width:0,height:0}},K=(e,t,[n,o,r]=[0,0,1],i=!1,a=!1)=>{let l={...ef(t,[n,o,r]),width:t.width/r,height:t.height/r},s=[];for(let t of e.values()){let{measured:e,selectable:n=!0,hidden:o=!1}=t;if(a&&!n||o)continue;let r=e.width??t.width??t.initialWidth??null,d=e.height??t.height??t.initialHeight??null,c=es(l,ei(t)),u=(r??0)*(d??0),h=i&&c>0;(!t.internals.handleBounds||h||c>=u||t.dragging)&&s.push(t)}return s};async function Y({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:i},a){let l,s;if(0===e.size)return Promise.resolve(!0);let d=em(X((l=new Map,s=a?.nodes?new Set(a.nodes.map(e=>e.id)):null,e.forEach(e=>{e.measured.width&&e.measured.height&&(a?.includeHiddenNodes||!e.hidden)&&(!s||s.has(e.id))&&l.set(e.id,e)}),l)),t,n,a?.minZoom??r,a?.maxZoom??i,a?.padding??.1);return await o.setViewport(d,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)}function U({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){let a=n.get(e),l=a.parentId?n.get(a.parentId):void 0,{x:s,y:d}=l?l.internals.positionAbsolute:{x:0,y:0},c=a.origin??o,u=a.extent||r;if("parent"!==a.extent||a.expandParent)l&&ey(a.extent)&&(u=[[a.extent[0][0]+s,a.extent[0][1]+d],[a.extent[1][0]+s,a.extent[1][1]+d]]);else if(l){let e=l.measured.width,t=l.measured.height;e&&t&&(u=[[s,d],[s+e,d+t]])}else i?.("005","Only child nodes can use a parent extent.");let h=ey(u)?G(t,u,a.measured):t;return(void 0===a.measured.width||void 0===a.measured.height)&&i?.("015","It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."),{position:{x:h.x-s+(a.measured.width??0)*c[0],y:h.y-d+(a.measured.height??0)*c[1]},positionAbsolute:h}}async function q({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){let i,a=new Set(e.map(e=>e.id)),l=[];for(let e of n){if(!1===e.deletable)continue;let t=a.has(e.id),n=!t&&e.parentId&&l.find(t=>t.id===e.parentId);(t||n)&&l.push(e)}let s=new Set(t.map(e=>e.id)),d=o.filter(e=>!1!==e.deletable),c=(i=new Set,l.forEach(e=>{i.add(e.id)}),d.filter(e=>i.has(e.source)||i.has(e.target)));for(let e of d)s.has(e.id)&&!c.find(t=>t.id===e.id)&&c.push(e);if(!r)return{edges:c,nodes:l};let u=await r({nodes:l,edges:c});return"boolean"==typeof u?u?{edges:c,nodes:l}:{edges:[],nodes:[]}:u}let Q=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),G=(e={x:0,y:0},t,n)=>({x:Q(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Q(e.y,t[0][1],t[1][1]-(n?.height??0))});function J(e,t,n){let{width:o,height:r}=ev(n),{x:i,y:a}=n.internals.positionAbsolute;return G(e,[[i,a],[i+o,a+r]],t)}let ee=(e,t,n)=>e<t?Q(Math.abs(e-t),1,t)/t:e>n?-Q(Math.abs(e-n),1,t)/t:0,et=(e,t,n=15,o=40)=>[ee(e.x,o,t.width-o)*n,ee(e.y,o,t.height-o)*n],en=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),eo=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),er=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),ei=(e,t=[0,0])=>{let{x:n,y:o}=Z(e)?e.internals.positionAbsolute:W(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},ea=(e,t=[0,0])=>{let{x:n,y:o}=Z(e)?e.internals.positionAbsolute:W(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},el=(e,t)=>er(en(eo(e),eo(t))),es=(e,t)=>Math.ceil(Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x))*Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y))),ed=e=>ec(e.width)&&ec(e.height)&&ec(e.x)&&ec(e.y),ec=e=>!isNaN(e)&&isFinite(e),eu=(e,t)=>{},eh=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),ef=({x:e,y:t},[n,o,r],i=!1,a=[1,1])=>{let l={x:(e-n)/r,y:(t-o)/r};return i?eh(l,a):l},eg=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function ep(e,t){if("number"==typeof e)return Math.floor((t-t/(1+e))*.5);if("string"==typeof e&&e.endsWith("px")){let t=parseFloat(e);if(!Number.isNaN(t))return Math.floor(t)}if("string"==typeof e&&e.endsWith("%")){let n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}let em=(e,t,n,o,r,i)=>{let a=function(e,t,n){if("string"==typeof e||"number"==typeof e){let o=ep(e,n),r=ep(e,t);return{top:o,right:r,bottom:o,left:r,x:2*r,y:2*o}}if("object"==typeof e){let o=ep(e.top??e.y??0,n),r=ep(e.bottom??e.y??0,n),i=ep(e.left??e.x??0,t),a=ep(e.right??e.x??0,t);return{top:o,right:a,bottom:r,left:i,x:i+a,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}(i,t,n),l=Q(Math.min((t-a.x)/e.width,(n-a.y)/e.height),o,r),s=e.x+e.width/2,d=e.y+e.height/2,c=t/2-s*l,u=n/2-d*l,h=function(e,t,n,o,r,i){let{x:a,y:l}=eg(e,[t,n,o]),{x:s,y:d}=eg({x:e.x+e.width,y:e.y+e.height},[t,n,o]);return{left:Math.floor(a),top:Math.floor(l),right:Math.floor(r-s),bottom:Math.floor(i-d)}}(e,c,u,l,t,n),f={left:Math.min(h.left-a.left,0),top:Math.min(h.top-a.top,0),right:Math.min(h.right-a.right,0),bottom:Math.min(h.bottom-a.bottom,0)};return{x:c-f.left+f.right,y:u-f.top+f.bottom,zoom:l}},ex=()=>"u">typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0;function ey(e){return null!=e&&"parent"!==e}function ev(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function eb(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function ew(e,t={width:0,height:0},n,o,r){let i={...e},a=o.get(n);if(a){let e=a.origin||r;i.x+=a.internals.positionAbsolute.x-(t.width??0)*e[0],i.y+=a.internals.positionAbsolute.y-(t.height??0)*e[1]}return i}function eS(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function eE(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){let{x:i,y:a}=ej(e),l=ef({x:i-(r?.left??0),y:a-(r?.top??0)},o),{x:s,y:d}=n?eh(l,t):l;return{xSnapped:s,ySnapped:d,...l}}let eM=e=>({width:e.offsetWidth,height:e.offsetHeight}),eC=e=>e?.getRootNode?.()||window?.document,eN=["INPUT","SELECT","TEXTAREA"];function ek(e){let t=e.composedPath?.()?.[0]||e.target;return t?.nodeType===1&&(eN.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey"))}let ej=(e,t)=>{let n="clientX"in e,o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},eP=(e,t,n,o,r)=>{let i=t.querySelectorAll(`.${e}`);return i&&i.length?Array.from(i).map(t=>{let i=t.getBoundingClientRect();return{id:t.getAttribute("data-handleid"),type:e,nodeId:r,position:t.getAttribute("data-handlepos"),x:(i.left-n.left)/o,y:(i.top-n.top)/o,...eM(t)}}):null};function eI({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:a,targetControlY:l}){let s=.125*e+.375*r+.375*a+.125*n,d=.125*t+.375*i+.375*l+.125*o,c=Math.abs(s-e),u=Math.abs(d-t);return[s,d,c,u]}function eA(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function eD({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case g.Left:return[t-eA(t-o,i),n];case g.Right:return[t+eA(o-t,i),n];case g.Top:return[t,n-eA(n-r,i)];case g.Bottom:return[t,n+eA(r-n,i)]}}function e$({sourceX:e,sourceY:t,sourcePosition:n=g.Bottom,targetX:o,targetY:r,targetPosition:i=g.Top,curvature:a=.25}){let[l,s]=eD({pos:n,x1:e,y1:t,x2:o,y2:r,c:a}),[d,c]=eD({pos:i,x1:o,y1:r,x2:e,y2:t,c:a}),[u,h,f,p]=eI({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:l,sourceControlY:s,targetControlX:d,targetControlY:c});return[`M${e},${t} C${l},${s} ${d},${c} ${o},${r}`,u,h,f,p]}function ez({sourceX:e,sourceY:t,targetX:n,targetY:o}){let r=Math.abs(n-e)/2,i=Math.abs(o-t)/2;return[n<e?n+r:n-r,o<t?o+i:o-i,r,i]}let e_=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`;function eL({sourceX:e,sourceY:t,targetX:n,targetY:o}){let[r,i,a,l]=ez({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,a,l]}let eR={[g.Left]:{x:-1,y:0},[g.Right]:{x:1,y:0},[g.Top]:{x:0,y:-1},[g.Bottom]:{x:0,y:1}},eO=({source:e,sourcePosition:t=g.Bottom,target:n})=>t===g.Left||t===g.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},eB=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function eH({sourceX:e,sourceY:t,sourcePosition:n=g.Bottom,targetX:o,targetY:r,targetPosition:i=g.Top,borderRadius:a=5,centerX:l,centerY:s,offset:d=20,stepPosition:c=.5}){let[u,h,f,p,m]=function({source:e,sourcePosition:t=g.Bottom,target:n,targetPosition:o=g.Top,center:r,offset:i,stepPosition:a}){let l,s,d=eR[t],c=eR[o],u={x:e.x+d.x*i,y:e.y+d.y*i},h={x:n.x+c.x*i,y:n.y+c.y*i},f=eO({source:u,sourcePosition:t,target:h}),p=0!==f.x?"x":"y",m=f[p],x=[],y={x:0,y:0},v={x:0,y:0},[,,b,w]=ez({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(d[p]*c[p]==-1){"x"===p?(l=r.x??u.x+(h.x-u.x)*a,s=r.y??(u.y+h.y)/2):(l=r.x??(u.x+h.x)/2,s=r.y??u.y+(h.y-u.y)*a);let e=[{x:l,y:u.y},{x:l,y:h.y}],t=[{x:u.x,y:s},{x:h.x,y:s}];x=d[p]===m?"x"===p?e:t:"x"===p?t:e}else{let r=[{x:u.x,y:h.y}],a=[{x:h.x,y:u.y}];if(x="x"===p?d.x===m?a:r:d.y===m?r:a,t===o){let t=Math.abs(e[p]-n[p]);if(t<=i){let o=Math.min(i-1,i-t);d[p]===m?y[p]=(u[p]>e[p]?-1:1)*o:v[p]=(h[p]>n[p]?-1:1)*o}}if(t!==o){let e="x"===p?"y":"x",t=d[p]===c[e],n=u[e]>h[e],o=u[e]<h[e];(1===d[p]&&(!t&&n||t&&o)||1!==d[p]&&(!t&&o||t&&n))&&(x="x"===p?r:a)}let f={x:u.x+y.x,y:u.y+y.y},g={x:h.x+v.x,y:h.y+v.y};Math.max(Math.abs(f.x-x[0].x),Math.abs(g.x-x[0].x))>=Math.max(Math.abs(f.y-x[0].y),Math.abs(g.y-x[0].y))?(l=(f.x+g.x)/2,s=x[0].y):(l=x[0].x,s=(f.y+g.y)/2)}return[[e,{x:u.x+y.x,y:u.y+y.y},...x,{x:h.x+v.x,y:h.y+v.y},n],l,s,b,w]}({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:l,y:s},offset:d,stepPosition:c});return[u.reduce((e,t,n)=>e+(n>0&&n<u.length-1?function(e,t,n,o){let r=Math.min(eB(e,t)/2,eB(t,n)/2,o),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return`L${i} ${a}`;if(e.y===a){let t=e.x<n.x?-1:1,o=e.y<n.y?1:-1;return`L ${i+r*t},${a}Q ${i},${a} ${i},${a+r*o}`}let l=e.x<n.x?1:-1,s=e.y<n.y?-1:1;return`L ${i},${a+r*s}Q ${i},${a} ${i+r*l},${a}`}(u[n-1],t,u[n+1],a):`${0===n?"M":"L"}${t.x} ${t.y}`),""),h,f,p,m]}function eT(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function eV(e){if(!e)return null;let t=[],n=[];for(let o of e)o.width=o.width??1,o.height=o.height??1,"source"===o.type?t.push(o):"target"===o.type&&n.push(o);return{source:t,target:n}}function eF(e,t,n=g.Left,o=!1){let r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:a,height:l}=t??ev(e);if(o)return{x:r+a/2,y:i+l/2};switch(t?.position??n){case g.Top:return{x:r+a/2,y:i};case g.Right:return{x:r+a,y:i+l/2};case g.Bottom:return{x:r+a/2,y:i+l};case g.Left:return{x:r,y:i+l/2}}}function eZ(e,t){return e&&(t?e.find(e=>e.id===t):e[0])||null}function eW(e,t){if(!e)return"";if("string"==typeof e)return e;let n=t?`${t}__`:"";return`${n}${Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join("&")}`}let eX={nodeOrigin:[0,0],nodeExtent:R,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},eK={...eX,checkEquality:!0};function eY(e,t){let n={...e};for(let e in t)void 0!==t[e]&&(n[e]=t[e]);return n}function eU(e){return"manual"===e}function eq(e,t,n,o={}){let r=eY(eK,o),i={i:0},a=new Map(t),l=r?.elevateNodesOnSelect&&!eU(r.zIndexMode)?1e3:0,s=e.length>0;for(let d of(t.clear(),n.clear(),e)){let e=a.get(d.id);if(r.checkEquality&&d===e?.internals.userNode)t.set(d.id,e);else{let n=G(W(d,r.nodeOrigin),ey(d.extent)?d.extent:r.nodeExtent,ev(d));e={...r.defaults,...d,measured:{width:d.measured?.width,height:d.measured?.height},internals:{positionAbsolute:n,handleBounds:function(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;let n=[],o=[];for(let t of e.handles){let r={id:t.id,width:t.width??1,height:t.height??1,nodeId:e.id,x:t.x,y:t.y,position:t.position,type:t.type};"source"===t.type?n.push(r):"target"===t.type&&o.push(r)}return{source:n,target:o}}(d,e),z:eG(d,l,r.zIndexMode),userNode:d}},t.set(d.id,e)}void 0!==e.measured&&void 0!==e.measured.width&&void 0!==e.measured.height||e.hidden||(s=!1),d.parentId&&eQ(e,t,n,o,i)}return s}function eQ(e,t,n,o,r){let{elevateNodesOnSelect:i,nodeOrigin:a,nodeExtent:l,zIndexMode:s}=eY(eX,o),d=e.parentId,c=t.get(d);if(!c)return void console.warn(`Parent node ${d} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);!function(e,t){if(!e.parentId)return;let n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}(e,n),r&&!c.parentId&&void 0===c.internals.rootParentIndex&&"auto"===s&&(c.internals.rootParentIndex=++r.i,c.internals.z=c.internals.z+10*r.i),r&&void 0!==c.internals.rootParentIndex&&(r.i=c.internals.rootParentIndex);let{x:u,y:h,z:f}=function(e,t,n,o,r,i){let{x:a,y:l}=t.internals.positionAbsolute,s=ev(e),d=W(e,n),c=ey(e.extent)?G(d,e.extent,s):d,u=G({x:a+c.x,y:l+c.y},o,s);"parent"===e.extent&&(u=J(u,s,t));let h=eG(e,r,i),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>=h?f+1:h}}(e,c,a,l,i&&!eU(s)?1e3:0,s),{positionAbsolute:g}=e.internals,p=u!==g.x||h!==g.y;(p||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:u,y:h}:g,z:f}})}function eG(e,t,n){let o=ec(e.zIndex)?e.zIndex:0;return eU(n)?o:o+(e.selected?t:0)}function eJ(e,t,n,o=[0,0]){let r=[],i=new Map;for(let n of e){let e=t.get(n.parentId);if(!e)continue;let o=el(i.get(n.parentId)?.expandedRect??ei(e),n.rect);i.set(n.parentId,{expandedRect:o,parent:e})}return i.size>0&&i.forEach(({expandedRect:t,parent:i},a)=>{let l=i.internals.positionAbsolute,s=ev(i),d=i.origin??o,c=t.x<l.x?Math.round(Math.abs(l.x-t.x)):0,u=t.y<l.y?Math.round(Math.abs(l.y-t.y)):0,h=Math.max(s.width,Math.round(t.width)),f=Math.max(s.height,Math.round(t.height)),g=(h-s.width)*d[0],p=(f-s.height)*d[1];(c>0||u>0||g||p)&&(r.push({id:a,type:"position",position:{x:i.position.x-c+g,y:i.position.y-u+p}}),n.get(a)?.forEach(t=>{e.some(e=>e.id===t.id)||r.push({id:t.id,type:"position",position:{x:t.position.x+c,y:t.position.y+u}})})),(s.width<t.width||s.height<t.height||c||u)&&r.push({id:a,type:"dimensions",setAttributes:!0,dimensions:{width:h+(c?d[0]*c-g:0),height:f+(u?d[1]*u-p:0)}})}),r}async function e0({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);let a=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],o);return Promise.resolve(!!a&&(a.x!==n[0]||a.y!==n[1]||a.k!==n[2]))}function e1(e,t,n,o,r,i){let a=r,l=o.get(a)||new Map;o.set(a,l.set(n,t)),a=`${r}-${e}`;let s=o.get(a)||new Map;if(o.set(a,s.set(n,t)),i){a=`${r}-${e}-${i}`;let l=o.get(a)||new Map;o.set(a,l.set(n,t))}}function e2(e,t,n){for(let o of(e.clear(),t.clear(),n)){let{source:n,target:r,sourceHandle:i=null,targetHandle:a=null}=o,l={edgeId:o.id,source:n,target:r,sourceHandle:i,targetHandle:a},s=`${n}-${i}--${r}-${a}`;e1("source",l,`${r}-${a}--${n}-${i}`,e,n,i),e1("target",l,s,e,r,a),t.set(o.id,o)}}function e3(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)break;o=o?.parentElement}while(o)return!1}function e4({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){let r=[];for(let[e,i]of t){let t=n.get(e)?.internals.userNode;t&&r.push({...t,position:i.position,dragging:o})}if(!e)return[r[0],r];let i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:o}:r[0],r]}function e5(e,t,n,o,r,i=!1){let a=o.get(e);if(!a)return null;let l="strict"===r?a.internals.handleBounds?.[t]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],s=(n?l?.find(e=>e.id===n):l?.[0])??null;return s&&i?{...s,...eF(a,s,s.position,!0)}:s}function e6(e,t){return e?e:t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null}let e8=()=>!0;function e7(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:a,lib:l,flowId:s,isValidConnection:c=e8,nodeLookup:u}){let h="target"===i,f=t?a.querySelector(`.${l}-flow__handle[data-id="${s}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:g,y:p}=ej(e),m=a.elementFromPoint(g,p),x=m?.classList.contains(`${l}-flow__handle`)?m:f,y={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){let e=e6(void 0,x),t=x.getAttribute("data-nodeid"),i=x.getAttribute("data-handleid"),a=x.classList.contains("connectable"),l=x.classList.contains("connectableend");if(!t||!e)return y;let s={source:h?t:o,sourceHandle:h?i:r,target:h?o:t,targetHandle:h?r:i};y.connection=s,y.isValid=a&&l&&(n===d.Strict?h&&"source"===e||!h&&"target"===e:t!==o||i!==r)&&c(s),y.toHandle=e5(t,e,i,u,n,!0)}return y}let e9=function(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:a,domNode:l,nodeLookup:s,lib:d,autoPanOnConnect:c,flowId:u,panBy:h,cancelConnection:f,onConnectStart:p,onConnect:m,onConnectEnd:x,isValidConnection:y=e8,onReconnectEnd:v,updateConnection:b,getTransform:w,getFromHandle:S,autoPanSpeed:E,dragThreshold:M=1,handleDomNode:C}){let N,k=eC(e.target),j=0,{x:P,y:I}=ej(e),A=e6(i,C),D=l?.getBoundingClientRect(),$=!1;if(!D||!A)return;let z=e5(r,A,o,s,t);if(!z)return;let _=ej(e,D),L=!1,R=null,O=!1,B=null,H={...z,nodeId:r,type:A,position:z.position},V=s.get(r),F={inProgress:!0,isValid:null,from:eF(V,H,g.Left,!0),fromHandle:H,fromPosition:H.position,fromNode:V,to:_,toHandle:null,toPosition:T[H.position],toNode:null,pointer:_};function Z(){$=!0,b(F),p?.(e,{nodeId:r,handleId:o,handleType:A})}function W(e){var i,l;let f;if(!$){let{x:t,y:n}=ej(e),o=t-P,r=n-I;if(!(o*o+r*r>M*M))return;Z()}if(!S()||!H)return void X(e);let p=w();N=function(e,t,n,o){let r=[],i=1/0;for(let a of function(e,t,n){let o=[],r={x:e.x-n,y:e.y-n,width:2*n,height:2*n};for(let e of t.values())es(r,ei(e))>0&&o.push(e);return o}(e,n,t+250))for(let n of[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]]){if(o.nodeId===n.nodeId&&o.type===n.type&&o.id===n.id)continue;let{x:l,y:s}=eF(a,n,n.position,!0),d=Math.sqrt(Math.pow(l-e.x,2)+Math.pow(s-e.y,2));d>t||(d<i?(r=[{...n,x:l,y:s}],i=d):d===i&&r.push({...n,x:l,y:s}))}if(!r.length)return null;if(r.length>1){let e="source"===o.type?"target":"source";return r.find(t=>t.type===e)??r[0]}return r[0]}(ef(_=ej(e,D),p,!1,[1,1]),n,s,H),L||(!function e(){if(!c||!D)return;let[t,n]=et(_,D,E);h({x:t,y:n}),j=requestAnimationFrame(e)}(),L=!0);let m=e7(e,{handle:N,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:a?"target":"source",isValidConnection:y,doc:k,lib:d,flowId:u,nodeLookup:s});B=m.handleDomNode,R=m.connection,i=!!N,l=m.isValid,f=null,l?f=!0:i&&!l&&(f=!1),O=f;let x=s.get(r),v=x?eF(x,H,g.Left,!0):F.from,C={...F,from:v,isValid:O,to:m.toHandle&&O?eg({x:m.toHandle.x,y:m.toHandle.y},p):_,toHandle:m.toHandle,toPosition:O&&m.toHandle?m.toHandle.position:T[H.position],toNode:m.toHandle?s.get(m.toHandle.nodeId):null,pointer:_};b(C),F=C}function X(e){if(!("touches"in e)||!(e.touches.length>0)){if($){(N||B)&&R&&O&&m?.(R);let{inProgress:t,...n}=F,o={...n,toPosition:F.toHandle?F.toPosition:null};x?.(e,o),i&&v?.(e,o)}f(),cancelAnimationFrame(j),L=!1,O=!1,R=null,B=null,k.removeEventListener("mousemove",W),k.removeEventListener("mouseup",X),k.removeEventListener("touchmove",W),k.removeEventListener("touchend",X)}}0===M&&Z(),k.addEventListener("mousemove",W),k.addEventListener("mouseup",X),k.addEventListener("touchmove",W),k.addEventListener("touchend",X)},te=e=>({x:e.x,y:e.y,zoom:e.k}),tt=({x:e,y:t,zoom:n})=>$.identity.translate(e,t).scale(n),tn=(e,t)=>e.target.closest(`.${t}`),to=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),tr=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,ti=(e,t=0,n=tr,o=()=>{})=>{let r="number"==typeof t&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},ta=e=>{let t=e.ctrlKey&&ex()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t};function tl(e){let t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:e.includes("left"),affectsY:e.includes("top")}}function ts(e,t){return Math.max(0,t-e)}function td(e,t){return Math.max(0,e-t)}function tc(e,t,n){return Math.max(0,t-e,e-n)}(l=p||(p={})).Line="line",l.Handle="handle";let tu={width:0,height:0,x:0,y:0},th={...tu,pointerX:0,pointerY:0,aspectRatio:1};var tf=e.i(30224);let tg={get url(){return`file://${e.P("node_modules/zustand/esm/vanilla.mjs")}`}},tp=e=>{let t,n=new Set,o=(e,o)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=o?o:"object"!=typeof r||null===r)?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,i={setState:o,getState:r,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{(tg.env?tg.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(o,r,i);return i},{useDebugValue:tm}=y.default,{useSyncExternalStoreWithSelector:tx}=tf.default,ty=e=>e;function tv(e,t=ty,n){let o=tx(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return tm(o),o}let tb=(e,t)=>{let n=e?tp(e):tp,o=(e,o=t)=>tv(n,e,o);return Object.assign(o,n),o};function tw(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,o]of e)if(!Object.is(o,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var tS=e.i(74080);let tE=(0,y.createContext)(null),tM=tE.Provider,tC="[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001";function tN(e,t){let n=(0,y.useContext)(tE);if(null===n)throw Error(tC);return tv(n,e,t)}function tk(){let e=(0,y.useContext)(tE);if(null===e)throw Error(tC);return(0,y.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}let tj={display:"none"},tP={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},tI="react-flow__node-desc",tA="react-flow__edge-desc",tD=e=>e.ariaLiveMessage,t$=e=>e.ariaLabelConfig;function tz({rfId:e}){let t=tN(tD);return(0,x.jsx)("div",{id:`react-flow__aria-live-${e}`,"aria-live":"assertive","aria-atomic":"true",style:tP,children:t})}function t_({rfId:e,disableKeyboardA11y:t}){let n=tN(t$);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{id:`${tI}-${e}`,style:tj,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),(0,x.jsx)("div",{id:`${tA}-${e}`,style:tj,children:n["edge.a11yDescription.default"]}),!t&&(0,x.jsx)(tz,{rfId:e})]})}let tL=(0,y.forwardRef)(({position:e="top-left",children:t,className:n,style:o,...r},i)=>{let a=`${e}`.split("-");return(0,x.jsx)("div",{className:v(["react-flow__panel",n,...a]),style:o,ref:i,...r,children:t})});function tR({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:(0,x.jsx)(tL,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,x.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}tL.displayName="Panel";let tO=e=>{let t=[],n=[];for(let[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(let[,t]of e.edgeLookup)t.selected&&n.push(t);return{selectedNodes:t,selectedEdges:n}},tB=e=>e.id;function tH(e,t){return tw(e.selectedNodes.map(tB),t.selectedNodes.map(tB))&&tw(e.selectedEdges.map(tB),t.selectedEdges.map(tB))}function tT({onSelectionChange:e}){let t=tk(),{selectedNodes:n,selectedEdges:o}=tN(tO,tH);return(0,y.useEffect)(()=>{let r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(e=>e(r))},[n,o,e]),null}let tV=e=>!!e.onSelectionChangeHandlers;function tF({onSelectionChange:e}){let t=tN(tV);return e||t?(0,x.jsx)(tT,{onSelectionChange:e}):null}let tZ=[0,0],tW={x:0,y:0,zoom:1},tX=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode","rfId"],tK=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),tY={translateExtent:R,nodeOrigin:tZ,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function tU(e){let{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:a,reset:l,setDefaultNodesAndEdges:s}=tN(tK,tw),d=tk();(0,y.useEffect)(()=>(s(e.defaultNodes,e.defaultEdges),()=>{c.current=tY,l()}),[]);let c=(0,y.useRef)(tY);return(0,y.useEffect)(()=>{for(let l of tX){let s=e[l];if(s!==c.current[l]&&void 0!==e[l])if("nodes"===l)t(s);else if("edges"===l)n(s);else if("minZoom"===l)o(s);else if("maxZoom"===l)r(s);else if("translateExtent"===l)i(s);else if("nodeExtent"===l)a(s);else if("ariaLabelConfig"===l)d.setState({ariaLabelConfig:{...B,...s||{}}});else"fitView"===l?d.setState({fitViewQueued:s}):"fitViewOptions"===l?d.setState({fitViewOptions:s}):d.setState({[l]:s})}c.current=e},tX.map(t=>e[t])),null}function tq(){return"u"<typeof window||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}let tQ="u">typeof document?document:null;function tG(e=null,t={target:tQ,actInsideInputWithModifier:!0}){let[n,o]=(0,y.useState)(!1),r=(0,y.useRef)(!1),i=(0,y.useRef)(new Set([])),[a,l]=(0,y.useMemo)(()=>{if(null!==e){let t=(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).map(e=>e.replace("+","\n").replace("\n\n","\n+").split("\n")),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return(0,y.useEffect)(()=>{let n=t?.target??tQ,s=t?.actInsideInputWithModifier??!0;if(null!==e){let e=e=>{if(r.current=e.ctrlKey||e.metaKey||e.shiftKey||e.altKey,(!r.current||r.current&&!s)&&ek(e))return!1;let n=t0(e.code,l);if(i.current.add(e[n]),tJ(a,i.current,!1)){let n=e.composedPath?.()?.[0]||e.target,i=n?.nodeName==="BUTTON"||n?.nodeName==="A";!1!==t.preventDefault&&(r.current||!i)&&e.preventDefault(),o(!0)}},d=e=>{let t=t0(e.code,l);tJ(a,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(e[t]),"Meta"===e.key&&i.current.clear(),r.current=!1},c=()=>{i.current.clear(),o(!1)};return n?.addEventListener("keydown",e),n?.addEventListener("keyup",d),window.addEventListener("blur",c),window.addEventListener("contextmenu",c),()=>{n?.removeEventListener("keydown",e),n?.removeEventListener("keyup",d),window.removeEventListener("blur",c),window.removeEventListener("contextmenu",c)}}},[e,o]),n}function tJ(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function t0(e,t){return t.includes(e)?"code":"key"}function t1(e,t){let n=[],o=new Map,r=[];for(let t of e)if("add"===t.type){r.push(t);continue}else if("remove"===t.type||"replace"===t.type)o.set(t.id,[t]);else{let e=o.get(t.id);e?e.push(t):o.set(t.id,[t])}for(let e of t){let t=o.get(e.id);if(!t){n.push(e);continue}if("remove"===t[0].type)continue;if("replace"===t[0].type){n.push({...t[0].item});continue}let r={...e};for(let e of t){var i=e,a=r;switch(i.type){case"select":a.selected=i.selected;break;case"position":void 0!==i.position&&(a.position=i.position),void 0!==i.dragging&&(a.dragging=i.dragging);break;case"dimensions":void 0!==i.dimensions&&(a.measured={...i.dimensions},i.setAttributes&&((!0===i.setAttributes||"width"===i.setAttributes)&&(a.width=i.dimensions.width),(!0===i.setAttributes||"height"===i.setAttributes)&&(a.height=i.dimensions.height))),"boolean"==typeof i.resizing&&(a.resizing=i.resizing)}}n.push(r)}return r.length&&r.forEach(e=>{void 0!==e.index?n.splice(e.index,0,{...e.item}):n.push({...e.item})}),n}function t2(e,t){return{id:e,type:"select",selected:t}}function t3(e,t=new Set,n=!1){let o=[];for(let[r,i]of e){let e=t.has(r);(void 0!==i.selected||e)&&i.selected!==e&&(n&&(i.selected=e),o.push(t2(i.id,e)))}return o}function t4({items:e=[],lookup:t}){let n=[],o=new Map(e.map(e=>[e.id,e]));for(let[o,r]of e.entries()){let e=t.get(r.id),i=e?.internals?.userNode??e;void 0!==i&&i!==r&&n.push({id:r.id,item:r,type:"replace"}),void 0===i&&n.push({item:r,type:"add",index:o})}for(let[e]of t)void 0===o.get(e)&&n.push({id:e,type:"remove"});return n}function t5(e){return{id:e.id,type:"remove"}}let t6=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e);function t8(e){return(0,y.forwardRef)(e)}let t7="u">typeof window?y.useLayoutEffect:y.useEffect;function t9(e){let[t,n]=(0,y.useState)(BigInt(0)),[o]=(0,y.useState)(()=>{var e;let t;return e=()=>n(e=>e+BigInt(1)),t=[],{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}});return t7(()=>{let t=o.get();t.length&&(e(t),o.reset())},[t]),o}let ne=(0,y.createContext)(null);function nt({children:e}){let t=tk(),n=t9((0,y.useCallback)(e=>{let{nodes:n=[],setNodes:o,hasDefaultNodes:r,onNodesChange:i,nodeLookup:a,fitViewQueued:l,onNodesChangeMiddlewareMap:s}=t.getState(),d=n;for(let t of e)d="function"==typeof t?t(d):t;let c=t4({items:d,lookup:a});for(let e of s.values())c=e(c);r&&o(d),c.length>0?i?.(c):l&&window.requestAnimationFrame(()=>{let{fitViewQueued:e,nodes:n,setNodes:o}=t.getState();e&&o(n)})},[])),o=t9((0,y.useCallback)(e=>{let{edges:n=[],setEdges:o,hasDefaultEdges:r,onEdgesChange:i,edgeLookup:a}=t.getState(),l=n;for(let t of e)l="function"==typeof t?t(l):t;r?o(l):i&&i(t4({items:l,lookup:a}))},[])),r=(0,y.useMemo)(()=>({nodeQueue:n,edgeQueue:o}),[]);return(0,x.jsx)(ne.Provider,{value:r,children:e})}let nn=e=>!!e.panZoom;function no(){let e,t=(e=tk(),(0,y.useMemo)(()=>({zoomIn:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{let{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{let{transform:[o,r,i],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{let{width:o,height:r,minZoom:i,maxZoom:a,panZoom:l}=e.getState(),s=em(t,o,r,i,a,n?.padding??.1);return l?(await l.setViewport(s,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{let{transform:o,snapGrid:r,snapToGrid:i,domNode:a}=e.getState();if(!a)return t;let{x:l,y:s}=a.getBoundingClientRect(),d={x:t.x-l,y:t.y-s},c=n.snapGrid??r;return ef(d,o,n.snapToGrid??i,c)},flowToScreenPosition:t=>{let{transform:n,domNode:o}=e.getState();if(!o)return t;let{x:r,y:i}=o.getBoundingClientRect(),a=eg(t,n);return{x:a.x+r,y:a.y+i}}}),[])),n=tk(),o=function(){let e=(0,y.useContext)(ne);if(!e)throw Error("useBatchContext must be used within a BatchProvider");return e}(),r=tN(nn),i=(0,y.useMemo)(()=>{let e=e=>n.getState().nodeLookup.get(e),t=e=>{o.nodeQueue.push(e)},r=e=>{o.edgeQueue.push(e)},i=e=>{let{nodeLookup:t,nodeOrigin:o}=n.getState(),r=t6(e)?e:t.get(e.id),i=r.parentId?ew(r.position,r.measured,r.parentId,t,o):r.position;return ei({...r,position:i,width:r.measured?.width??r.width,height:r.measured?.height??r.height})},a=(e,n,o={replace:!1})=>{t(t=>t.map(t=>{if(t.id===e){let e="function"==typeof n?n(t):n;return o.replace&&t6(e)?e:{...t,...e}}return t}))},l=(e,t,n={replace:!1})=>{r(o=>o.map(o=>{if(o.id===e){let e="function"==typeof t?t(o):t;return n.replace&&F(e)?e:{...o,...e}}return o}))};return{getNodes:()=>n.getState().nodes.map(e=>({...e})),getNode:t=>e(t)?.internals.userNode,getInternalNode:e,getEdges:()=>{let{edges:e=[]}=n.getState();return e.map(e=>({...e}))},getEdge:e=>n.getState().edgeLookup.get(e),setNodes:t,setEdges:r,addNodes:e=>{let t=Array.isArray(e)?e:[e];o.nodeQueue.push(e=>[...e,...t])},addEdges:e=>{let t=Array.isArray(e)?e:[e];o.edgeQueue.push(e=>[...e,...t])},toObject:()=>{let{nodes:e=[],edges:t=[],transform:o}=n.getState(),[r,i,a]=o;return{nodes:e.map(e=>({...e})),edges:t.map(e=>({...e})),viewport:{x:r,y:i,zoom:a}}},deleteElements:async({nodes:e=[],edges:t=[]})=>{let{nodes:o,edges:r,onNodesDelete:i,onEdgesDelete:a,triggerNodeChanges:l,triggerEdgeChanges:s,onDelete:d,onBeforeDelete:c}=n.getState(),{nodes:u,edges:h}=await q({nodesToRemove:e,edgesToRemove:t,nodes:o,edges:r,onBeforeDelete:c}),f=h.length>0,g=u.length>0;if(f){let e=h.map(t5);a?.(h),s(e)}if(g){let e=u.map(t5);i?.(u),l(e)}return(g||f)&&d?.({nodes:u,edges:h}),{deletedNodes:u,deletedEdges:h}},getIntersectingNodes:(e,t=!0,o)=>{let r=ed(e),a=r?e:i(e),l=void 0!==o;return a?(o||n.getState().nodes).filter(o=>{let i=n.getState().nodeLookup.get(o.id);if(i&&!r&&(o.id===e.id||!i.internals.positionAbsolute))return!1;let s=ei(l?o:i),d=es(s,a);return t&&d>0||d>=s.width*s.height||d>=a.width*a.height}):[]},isNodeIntersecting:(e,t,n=!0)=>{let o=ed(e)?e:i(e);if(!o)return!1;let r=es(o,t);return n&&r>0||r>=t.width*t.height||r>=o.width*o.height},updateNode:a,updateNodeData:(e,t,n={replace:!1})=>{a(e,e=>{let o="function"==typeof t?t(e):t;return n.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},n)},updateEdge:l,updateEdgeData:(e,t,n={replace:!1})=>{l(e,e=>{let o="function"==typeof t?t(e):t;return n.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},n)},getNodesBounds:e=>{let{nodeLookup:t,nodeOrigin:o}=n.getState();return((e,t={nodeOrigin:[0,0]})=>0===e.length?{x:0,y:0,width:0,height:0}:er(e.reduce((e,n)=>{let o="string"==typeof n,r=t.nodeLookup||o?void 0:n;return t.nodeLookup&&(r=o?t.nodeLookup.get(n):Z(n)?n:t.nodeLookup.get(n.id)),en(e,r?ea(r,t.nodeOrigin):{x:0,y:0,x2:0,y2:0})},{x:1/0,y:1/0,x2:-1/0,y2:-1/0})))(e,{nodeLookup:t,nodeOrigin:o})},getHandleConnections:({type:e,id:t,nodeId:o})=>Array.from(n.getState().connectionLookup.get(`${o}-${e}${t?`-${t}`:""}`)?.values()??[]),getNodeConnections:({type:e,handleId:t,nodeId:o})=>Array.from(n.getState().connectionLookup.get(`${o}${e?t?`-${e}-${t}`:`-${e}`:""}`)?.values()??[]),fitView:async e=>{let t,r,i=n.getState().fitViewResolver??{promise:new Promise((e,n)=>{t=e,r=n}),resolve:t,reject:r};return n.setState({fitViewQueued:!0,fitViewOptions:e,fitViewResolver:i}),o.nodeQueue.push(e=>[...e]),i.promise}}},[]);return(0,y.useMemo)(()=>({...i,...t,viewportInitialized:r}),[r])}let nr=e=>e.selected,ni="u">typeof window?window:void 0,na={position:"absolute",width:"100%",height:"100%",top:0,left:0},nl=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function ns({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=c.Free,zoomOnDoubleClick:a=!0,panOnDrag:l=!0,defaultViewport:s,translateExtent:d,minZoom:u,maxZoom:h,zoomActivationKeyCode:f,preventScrolling:g=!0,children:p,noWheelClassName:m,noPanClassName:v,onViewportChange:b,isControlledViewport:E,paneClickDistance:M,selectionOnDrag:C}){let N,k=tk(),j=(0,y.useRef)(null),{userSelectionActive:P,lib:I,connectionInProgress:A}=tN(nl,tw),$=tG(f),R=(0,y.useRef)();N=tk(),(0,y.useEffect)(()=>{let e=()=>{if(!j.current||!(j.current.checkVisibility?.()??!0))return!1;let e=eM(j.current);(0===e.height||0===e.width)&&N.getState().onError?.("004","The React Flow parent container needs a width and a height to render the graph."),N.setState({width:e.width||500,height:e.height||500})};if(j.current){e(),window.addEventListener("resize",e);let t=new ResizeObserver(()=>e());return t.observe(j.current),()=>{window.removeEventListener("resize",e),t&&j.current&&t.unobserve(j.current)}}},[]);let O=(0,y.useCallback)(e=>{b?.({x:e[0],y:e[1],zoom:e[2]}),E||k.setState({transform:e})},[b,E]);return(0,y.useEffect)(()=>{if(j.current){R.current=function({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:r,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:s}){let d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=e.getBoundingClientRect(),h=(0,D.default)().scaleExtent([t,n]).translateExtent(o),f=(0,w.select)(e).call(h);y({x:r.x,y:r.y,zoom:Q(r.zoom,t,n)},[[0,0],[u.width,u.height]],o);let g=f.on("wheel.zoom"),p=f.on("dblclick.zoom");function m(e,t){return f?new Promise(n=>{h?.interpolate(t?.interpolate==="linear"?L.interpolate:_.interpolateZoom).transform(ti(f,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)}function x(){h.on("zoom",null)}async function y(e,t,n){let o=tt(e),r=h?.constrain()(o,t,n);return r&&await m(r),new Promise(e=>e(r))}return h.wheelDelta(ta),{update:function({noWheelClassName:e,noPanClassName:t,onPaneContextMenu:n,userSelectionActive:o,panOnScroll:r,panOnDrag:u,panOnScrollMode:m,panOnScrollSpeed:y,preventScrolling:v,zoomOnPinch:b,zoomOnScroll:w,zoomOnDoubleClick:E,zoomActivationKeyPressed:M,lib:C,onTransformChange:N,connectionInProgress:k,paneClickDistance:j,selectionOnDrag:P}){o&&!d.isZoomingOrPanning&&x();let I=r&&!M&&!o;h.clickDistance(P?1/0:!ec(j)||j<0?0:j);let A=I?function({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:a,onPanZoomStart:l,onPanZoom:s,onPanZoomEnd:d}){return u=>{if(tn(u,t))return u.ctrlKey&&u.preventDefault(),!1;u.preventDefault(),u.stopImmediatePropagation();let h=n.property("__zoom").k||1;if(u.ctrlKey&&a){let e=(0,S.pointer)(u),t=h*Math.pow(2,ta(u));o.scaleTo(n,t,e,u);return}let f=1===u.deltaMode?20:1,g=r===c.Vertical?0:u.deltaX*f,p=r===c.Horizontal?0:u.deltaY*f;!ex()&&u.shiftKey&&r!==c.Vertical&&(g=u.deltaY*f,p=0),o.translateBy(n,-(g/h)*i,-(p/h)*i,{internal:!0});let m=te(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(s?.(u,m),e.panScrollTimeout=setTimeout(()=>{d?.(u,m),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,l?.(u,m))}}({zoomPanValues:d,noWheelClassName:e,d3Selection:f,d3Zoom:h,panOnScrollMode:m,panOnScrollSpeed:y,zoomOnPinch:b,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:l}):function({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){let i="wheel"===o.type,a=!t&&i&&!o.ctrlKey,l=tn(o,e);if(o.ctrlKey&&i&&l&&o.preventDefault(),a||l)return null;o.preventDefault(),n.call(this,o,r)}}({noWheelClassName:e,preventScrolling:v,d3ZoomHandler:g});if(f.on("wheel.zoom",A,{passive:!1}),!o){let e=function({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;let r=te(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}({zoomPanValues:d,onDraggingChange:s,onPanZoomStart:a});h.on("start",e);let t=function({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{e.usedRightMouseButton=!!(n&&to(t,e.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,te(i.transform))}}({zoomPanValues:d,panOnDrag:u,onPaneContextMenu:!!n,onPanZoom:i,onTransformChange:N});h.on("zoom",t);let o=function({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return a=>{if(!a.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&to(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&i(a.sourceEvent),e.usedRightMouseButton=!1,o(!1),r)){let t=te(a.transform);e.prevViewport=t,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(a.sourceEvent,t)},150*!!n)}}}({zoomPanValues:d,panOnDrag:u,panOnScroll:r,onPaneContextMenu:n,onPanZoomEnd:l,onDraggingChange:s});h.on("end",o)}let D=function({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:a,noWheelClassName:l,noPanClassName:s,lib:d,connectionInProgress:c}){return u=>{let h=e||t,f=n&&u.ctrlKey,g="wheel"===u.type;if(1===u.button&&"mousedown"===u.type&&(tn(u,`${d}-flow__node`)||tn(u,`${d}-flow__edge`)))return!0;if(!o&&!h&&!r&&!i&&!n||a||c&&!g||tn(u,l)&&g||tn(u,s)&&(!g||r&&g&&!e)||!n&&u.ctrlKey&&g)return!1;if(!n&&"touchstart"===u.type&&u.touches?.length>1)return u.preventDefault(),!1;if(!h&&!r&&!f&&g||!o&&("mousedown"===u.type||"touchstart"===u.type)||Array.isArray(o)&&!o.includes(u.button)&&"mousedown"===u.type)return!1;let p=Array.isArray(o)&&o.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||g)&&p}}({zoomActivationKeyPressed:M,panOnDrag:u,zoomOnScroll:w,panOnScroll:r,zoomOnDoubleClick:E,zoomOnPinch:b,userSelectionActive:o,noPanClassName:t,noWheelClassName:e,lib:C,connectionInProgress:k});h.filter(D),E?f.on("dblclick.zoom",p):f.on("dblclick.zoom",null)},destroy:x,setViewport:async function e(e,t){let n=tt(e);return await m(n,t),new Promise(e=>e(n))},setViewportConstrained:y,getViewport:function(){let e=f?(0,z.default)(f.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}},scaleTo:function(e,t){return f?new Promise(n=>{h?.interpolate(t?.interpolate==="linear"?L.interpolate:_.interpolateZoom).scaleTo(ti(f,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)},scaleBy:function(e,t){return f?new Promise(n=>{h?.interpolate(t?.interpolate==="linear"?L.interpolate:_.interpolateZoom).scaleBy(ti(f,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)},setScaleExtent:function(e){h?.scaleExtent(e)},setTranslateExtent:function(e){h?.translateExtent(e)},syncViewport:function(e){if(f){let t=tt(e),n=f.property("__zoom");(n.k!==e.zoom||n.x!==e.x||n.y!==e.y)&&h?.transform(f,t,null,{sync:!0})}},setClickDistance:function(e){let t=!ec(e)||e<0?0:e;h?.clickDistance(t)}}}({domNode:j.current,minZoom:u,maxZoom:h,translateExtent:d,viewport:s,onDraggingChange:e=>k.setState({paneDragging:e}),onPanZoomStart:(e,t)=>{let{onViewportChangeStart:n,onMoveStart:o}=k.getState();o?.(e,t),n?.(t)},onPanZoom:(e,t)=>{let{onViewportChange:n,onMove:o}=k.getState();o?.(e,t),n?.(t)},onPanZoomEnd:(e,t)=>{let{onViewportChangeEnd:n,onMoveEnd:o}=k.getState();o?.(e,t),n?.(t)}});let{x:e,y:t,zoom:n}=R.current.getViewport();return k.setState({panZoom:R.current,transform:[e,t,n],domNode:j.current.closest(".react-flow")}),()=>{R.current?.destroy()}}},[]),(0,y.useEffect)(()=>{R.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:a,panOnDrag:l,zoomActivationKeyPressed:$,preventScrolling:g,noPanClassName:v,userSelectionActive:P,noWheelClassName:m,lib:I,onTransformChange:O,connectionInProgress:A,selectionOnDrag:C,paneClickDistance:M})},[e,t,n,o,r,i,a,l,$,g,v,P,m,I,O,A,C,M]),(0,x.jsx)("div",{className:"react-flow__renderer",ref:j,style:na,children:p})}let nd=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function nc(){let{userSelectionActive:e,userSelectionRect:t}=tN(nd,tw);return e&&t?(0,x.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}let nu=(e,t)=>n=>{n.target===t.current&&e?.(n)},nh=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function nf({isSelecting:e,selectionKeyPressed:t,selectionMode:n=u.Full,panOnDrag:o,paneClickDistance:r,selectionOnDrag:i,onSelectionStart:a,onSelectionEnd:l,onPaneClick:s,onPaneContextMenu:d,onPaneScroll:c,onPaneMouseEnter:h,onPaneMouseMove:f,onPaneMouseLeave:g,children:p}){let m=tk(),{userSelectionActive:b,elementsSelectable:w,dragging:S,connectionInProgress:E}=tN(nh,tw),M=w&&(e||b),C=(0,y.useRef)(null),N=(0,y.useRef)(),k=(0,y.useRef)(new Set),j=(0,y.useRef)(new Set),P=(0,y.useRef)(!1),I=e=>{if(P.current||E){P.current=!1;return}s?.(e),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},A=!0===o||Array.isArray(o)&&o.includes(0);return(0,x.jsxs)("div",{className:v(["react-flow__pane",{draggable:A,dragging:S,selection:e}]),onClick:M?void 0:nu(I,C),onContextMenu:nu(e=>{Array.isArray(o)&&o?.includes(2)?e.preventDefault():d?.(e)},C),onWheel:nu(c?e=>c(e):void 0,C),onPointerEnter:M?void 0:h,onPointerMove:M?e=>{let{userSelectionRect:o,transform:i,nodeLookup:l,edgeLookup:s,connectionLookup:d,triggerNodeChanges:c,triggerEdgeChanges:h,defaultEdgeOptions:f,resetSelectedElements:g}=m.getState();if(!N.current||!o)return;let{x:p,y:x}=ej(e.nativeEvent,N.current),{startX:y,startY:v}=o;if(!P.current){if(Math.hypot(p-y,x-v)<=(t?0:r))return;g(),a?.(e)}P.current=!0;let b={startX:y,startY:v,x:p<y?p:y,y:x<v?x:v,width:Math.abs(p-y),height:Math.abs(x-v)},w=k.current,S=j.current;k.current=new Set(K(l,b,i,n===u.Partial,!0).map(e=>e.id)),j.current=new Set;let E=f?.selectable??!0;for(let e of k.current){let t=d.get(e);if(t)for(let{edgeId:e}of t.values()){let t=s.get(e);t&&(t.selectable??E)&&j.current.add(e)}}eS(w,k.current)||c(t3(l,k.current,!0)),eS(S,j.current)||h(t3(s,j.current)),m.setState({userSelectionRect:b,userSelectionActive:!0,nodesSelectionActive:!1})}:f,onPointerUp:M?e=>{0===e.button&&(e.target?.releasePointerCapture?.(e.pointerId),!b&&e.target===C.current&&m.getState().userSelectionRect&&I?.(e),m.setState({userSelectionActive:!1,userSelectionRect:null}),P.current&&(l?.(e),m.setState({nodesSelectionActive:k.current.size>0})))}:void 0,onPointerDownCapture:M?n=>{let{domNode:o}=m.getState();if(N.current=o?.getBoundingClientRect(),!N.current)return;let r=n.target===C.current;if(!r&&n.target.closest(".nokey")||!e||!(i&&r||t)||0!==n.button||!n.isPrimary)return;n.target?.setPointerCapture?.(n.pointerId),P.current=!1;let{x:a,y:l}=ej(n.nativeEvent,N.current);m.setState({userSelectionRect:{width:0,height:0,startX:a,startY:l,x:a,y:l}}),r||(n.stopPropagation(),n.preventDefault())}:void 0,onClickCapture:M?e=>{P.current&&(e.stopPropagation(),P.current=!1)}:void 0,onPointerLeave:g,ref:C,style:na,children:[p,(0,x.jsx)(nc,{})]})}function ng({id:e,store:t,unselect:n=!1,nodeRef:o}){let r,{addSelectedNodes:i,unselectNodesAndEdges:a,multiSelectionActive:l,nodeLookup:s,onError:d}=t.getState(),c=s.get(e);c?(t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&l)&&(a({nodes:[c],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):i([e])):d?.("012",(r=e,`Node with id "${r}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`))}function np({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:i,nodeClickDistance:a}){let l=tk(),[s,d]=(0,y.useState)(!1),c=(0,y.useRef)();return(0,y.useEffect)(()=>{c.current=function({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},a=0,l=new Map,s=!1,d={x:0,y:0},c=null,u=!1,h=null,f=!1,g=!1,p=null;return{update:function({noDragClassName:m,handleSelector:x,domNode:y,isSelectable:v,nodeId:b,nodeClickDistance:S=0}){function E({x:e,y:n}){let{nodeLookup:r,nodeExtent:a,snapGrid:s,snapToGrid:d,nodeOrigin:c,onNodeDrag:u,onSelectionDrag:h,onError:f,updateNodePositions:m}=t();i={x:e,y:n};let x=!1,y=l.size>1,v=y&&a?eo(X(l)):null,w=y&&d?function({dragItems:e,snapGrid:t,x:n,y:o}){let r=e.values().next().value;if(!r)return null;let i={x:n-r.distance.x,y:o-r.distance.y},a=eh(i,t);return{x:a.x-i.x,y:a.y-i.y}}({dragItems:l,snapGrid:s,x:e,y:n}):null;for(let[t,o]of l){if(!r.has(t))continue;let i={x:e-o.distance.x,y:n-o.distance.y};d&&(i=w?{x:Math.round(i.x+w.x),y:Math.round(i.y+w.y)}:eh(i,s));let l=null;if(y&&a&&!o.extent&&v){let{positionAbsolute:e}=o.internals,t=e.x-v.x+a[0][0],n=e.x+o.measured.width-v.x2+a[1][0];l=[[t,e.y-v.y+a[0][1]],[n,e.y+o.measured.height-v.y2+a[1][1]]]}let{position:u,positionAbsolute:h}=U({nodeId:t,nextPosition:i,nodeLookup:r,nodeExtent:l||a,nodeOrigin:c,onError:f});x=x||o.position.x!==u.x||o.position.y!==u.y,o.position=u,o.internals.positionAbsolute=h}if(g=g||x,x&&(m(l,!0),p&&(o||u||!b&&h))){let[e,t]=e4({nodeId:b,dragItems:l,nodeLookup:r});o?.(p,l,e,t),u?.(p,e,t),b||h?.(p,t)}}async function M(){if(!c)return;let{transform:e,panBy:n,autoPanSpeed:o,autoPanOnNodeDrag:r}=t();if(!r){s=!1,cancelAnimationFrame(a);return}let[l,u]=et(d,c,o);(0!==l||0!==u)&&(i.x=(i.x??0)-l/e[2],i.y=(i.y??0)-u/e[2],await n({x:l,y:u})&&E(i)),a=requestAnimationFrame(M)}function C(o){let{nodeLookup:r,multiSelectionActive:a,nodesDraggable:s,transform:d,snapGrid:h,snapToGrid:f,selectNodesOnDrag:g,onNodeDragStart:p,onSelectionDragStart:m,unselectNodesAndEdges:x}=t();u=!0,g&&v||a||!b||r.get(b)?.selected||x(),v&&g&&b&&e?.(b);let y=eE(o.sourceEvent,{transform:d,snapGrid:h,snapToGrid:f,containerBounds:c});if(i=y,(l=function(e,t,n,o){let r=new Map;for(let[i,a]of e)if((a.selected||a.id===o)&&(!a.parentId||!function e(t,n){if(!t.parentId)return!1;let o=n.get(t.parentId);return!!o&&(!!o.selected||e(o,n))}(a,e))&&(a.draggable||t&&void 0===a.draggable)){let t=e.get(i);t&&r.set(i,{id:i,position:t.position||{x:0,y:0},distance:{x:n.x-t.internals.positionAbsolute.x,y:n.y-t.internals.positionAbsolute.y},extent:t.extent,parentId:t.parentId,origin:t.origin,expandParent:t.expandParent,internals:{positionAbsolute:t.internals.positionAbsolute||{x:0,y:0}},measured:{width:t.measured.width??0,height:t.measured.height??0}})}return r}(r,s,y,b)).size>0&&(n||p||!b&&m)){let[e,t]=e4({nodeId:b,dragItems:l,nodeLookup:r});n?.(o.sourceEvent,l,e,t),p?.(o.sourceEvent,e,t),b||m?.(o.sourceEvent,t)}}h=(0,w.select)(y);let N=A().clickDistance(S).on("start",e=>{let{domNode:n,nodeDragThreshold:o,transform:r,snapGrid:a,snapToGrid:l}=t();c=n?.getBoundingClientRect()||null,f=!1,g=!1,p=e.sourceEvent,0===o&&C(e),i=eE(e.sourceEvent,{transform:r,snapGrid:a,snapToGrid:l,containerBounds:c}),d=ej(e.sourceEvent,c)}).on("drag",e=>{let{autoPanOnNodeDrag:n,transform:o,snapGrid:r,snapToGrid:a,nodeDragThreshold:h,nodeLookup:g}=t(),m=eE(e.sourceEvent,{transform:o,snapGrid:r,snapToGrid:a,containerBounds:c});if(p=e.sourceEvent,("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1||b&&!g.has(b))&&(f=!0),!f){if(!s&&n&&u&&(s=!0,M()),!u){let t=ej(e.sourceEvent,c),n=t.x-d.x,o=t.y-d.y;Math.sqrt(n*n+o*o)>h&&C(e)}(i.x!==m.xSnapped||i.y!==m.ySnapped)&&l&&u&&(d=ej(e.sourceEvent,c),E(m))}}).on("end",e=>{if(u&&!f&&(s=!1,u=!1,cancelAnimationFrame(a),l.size>0)){let{nodeLookup:n,updateNodePositions:o,onNodeDragStop:i,onSelectionDragStop:a}=t();if(g&&(o(l,!1),g=!1),r||i||!b&&a){let[t,o]=e4({nodeId:b,dragItems:l,nodeLookup:n,dragging:!1});r?.(e.sourceEvent,l,t,o),i?.(e.sourceEvent,t,o),b||a?.(e.sourceEvent,o)}}}).filter(e=>{let t=e.target;return!e.button&&(!m||!e3(t,`.${m}`,y))&&(!x||e3(t,x,y))});h.call(N)},destroy:function(){h?.on(".drag",null)}}}({getStoreItems:()=>l.getState(),onNodeMouseDown:t=>{ng({id:t,store:l,nodeRef:e})},onDragStart:()=>{d(!0)},onDragStop:()=>{d(!1)}})},[]),(0,y.useEffect)(()=>{if(t)c.current?.destroy();else if(e.current)return c.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:i,nodeId:r,nodeClickDistance:a}),()=>{c.current?.destroy()}},[n,o,t,i,e,r]),s}function nm(){let e=tk();return(0,y.useCallback)(t=>{let{nodeExtent:n,snapToGrid:o,snapGrid:r,nodesDraggable:i,onError:a,updateNodePositions:l,nodeLookup:s,nodeOrigin:d}=e.getState(),c=new Map,u=e=>e.selected&&(e.draggable||i&&void 0===e.draggable),h=o?r[0]:5,f=o?r[1]:5,g=t.direction.x*h*t.factor,p=t.direction.y*f*t.factor;for(let[,e]of s){if(!u(e))continue;let t={x:e.internals.positionAbsolute.x+g,y:e.internals.positionAbsolute.y+p};o&&(t=eh(t,r));let{position:i,positionAbsolute:l}=U({nodeId:e.id,nextPosition:t,nodeLookup:s,nodeExtent:n,nodeOrigin:d,onError:a});e.position=i,e.internals.positionAbsolute=l,c.set(e.id,e)}l(c)},[])}let nx=(0,y.createContext)(null),ny=nx.Provider;nx.Consumer;let nv=()=>(0,y.useContext)(nx),nb=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),nw=(0,y.memo)(t8(function({type:e="source",position:t=g.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:a,onConnect:l,children:s,className:c,onMouseDown:u,onTouchStart:h,...f},p){let m=a||null,y="target"===e,b=tk(),w=nv(),{connectOnClick:S,noPanClassName:E,rfId:M}=tN(nb,tw),{connectingFrom:C,connectingTo:N,clickConnecting:k,isPossibleEndHandle:j,connectionInProcess:P,clickConnectionInProcess:I,valid:A}=tN(t=>{let{connectionClickStartHandle:n,connectionMode:o,connection:r}=t,{fromHandle:i,toHandle:a,isValid:l}=r,s=a?.nodeId===w&&a?.id===m&&a?.type===e;return{connectingFrom:i?.nodeId===w&&i?.id===m&&i?.type===e,connectingTo:s,clickConnecting:n?.nodeId===w&&n?.id===m&&n?.type===e,isPossibleEndHandle:o===d.Strict?i?.type!==e:w!==i?.nodeId||m!==i?.id,connectionInProcess:!!i,clickConnectionInProcess:!!n,valid:s&&l}},tw);w||b.getState().onError?.("010","Handle: No node id found. Make sure to only use a Handle inside a custom Node.");let D=e=>{let{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:o}=b.getState(),r={...t,...e};if(o){let{edges:e,setEdges:t}=b.getState();t(((e,t,n={})=>{let o,r;if(!e.source||!e.target)return eu("006","Can't create edge. An edge needs a source and a target."),t;let i=n.getEdgeId||e_;return(r=o=F(e)?{...e}:{...e,id:i(e)},t.some(e=>e.source===r.source&&e.target===r.target&&(e.sourceHandle===r.sourceHandle||!e.sourceHandle&&!r.sourceHandle)&&(e.targetHandle===r.targetHandle||!e.targetHandle&&!r.targetHandle)))?t:(null===o.sourceHandle&&delete o.sourceHandle,null===o.targetHandle&&delete o.targetHandle,t.concat(o))})(r,e))}n?.(r),l?.(r)},$=e=>{if(!w)return;let t="clientX"in e.nativeEvent;if(r&&(t&&0===e.button||!t)){let t=b.getState();e9(e.nativeEvent,{handleDomNode:e.currentTarget,autoPanOnConnect:t.autoPanOnConnect,connectionMode:t.connectionMode,connectionRadius:t.connectionRadius,domNode:t.domNode,nodeLookup:t.nodeLookup,lib:t.lib,isTarget:y,handleId:m,nodeId:w,flowId:t.rfId,panBy:t.panBy,cancelConnection:t.cancelConnection,onConnectStart:t.onConnectStart,onConnectEnd:t.onConnectEnd,updateConnection:t.updateConnection,onConnect:D,isValidConnection:n||t.isValidConnection,getTransform:()=>b.getState().transform,getFromHandle:()=>b.getState().connection.fromHandle,autoPanSpeed:t.autoPanSpeed,dragThreshold:t.connectionDragThreshold})}t?u?.(e):h?.(e)};return(0,x.jsx)("div",{"data-handleid":m,"data-nodeid":w,"data-handlepos":t,"data-id":`${M}-${w}-${m}-${e}`,className:v(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",E,c,{source:!y,target:y,connectable:o,connectablestart:r,connectableend:i,clickconnecting:k,connectingfrom:C,connectingto:N,valid:A,connectionindicator:o&&(!P||j)&&(P||I?i:r)}]),onMouseDown:$,onTouchStart:$,onClick:S?t=>{let{onClickConnectStart:o,onClickConnectEnd:i,connectionClickStartHandle:a,connectionMode:l,isValidConnection:s,lib:d,rfId:c,nodeLookup:u,connection:h}=b.getState();if(!w||!a&&!r)return;if(!a){o?.(t.nativeEvent,{nodeId:w,handleId:m,handleType:e}),b.setState({connectionClickStartHandle:{nodeId:w,type:e,id:m}});return}let f=eC(t.target),g=n||s,{connection:p,isValid:x}=e7(t.nativeEvent,{handle:{nodeId:w,id:m,type:e},connectionMode:l,fromNodeId:a.nodeId,fromHandleId:a.id||null,fromType:a.type,isValidConnection:g,flowId:c,doc:f,lib:d,nodeLookup:u});x&&p&&D(p);let y=structuredClone(h);delete y.inProgress,y.toPosition=y.toHandle?y.toHandle.position:null,i?.(t,y),b.setState({connectionClickStartHandle:null})}:void 0,ref:p,...f,children:s})})),nS={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},nE={input:function({data:e,isConnectable:t,sourcePosition:n=g.Bottom}){return(0,x.jsxs)(x.Fragment,{children:[e?.label,(0,x.jsx)(nw,{type:"source",position:n,isConnectable:t})]})},default:function({data:e,isConnectable:t,targetPosition:n=g.Top,sourcePosition:o=g.Bottom}){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(nw,{type:"target",position:n,isConnectable:t}),e?.label,(0,x.jsx)(nw,{type:"source",position:o,isConnectable:t})]})},output:function({data:e,isConnectable:t,targetPosition:n=g.Top}){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(nw,{type:"target",position:n,isConnectable:t}),e?.label]})},group:function(){return null}},nM=e=>{let{width:t,height:n,x:o,y:r}=X(e.nodeLookup,{filter:e=>!!e.selected});return{width:ec(t)?t:null,height:ec(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function nC({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let o=tk(),{width:r,height:i,transformString:a,userSelectionActive:l}=tN(nM,tw),s=nm(),d=(0,y.useRef)(null);if((0,y.useEffect)(()=>{n||d.current?.focus({preventScroll:!0})},[n]),np({nodeRef:d}),l||!r||!i)return null;let c=e?t=>{e(t,o.getState().nodes.filter(e=>e.selected))}:void 0;return(0,x.jsx)("div",{className:v(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a},children:(0,x.jsx)("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:c,tabIndex:n?void 0:-1,onKeyDown:n?void 0:e=>{Object.prototype.hasOwnProperty.call(nS,e.key)&&(e.preventDefault(),s({direction:nS[e.key],factor:e.shiftKey?4:1}))},style:{width:r,height:i}})})}let nN="u">typeof window?window:void 0,nk=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function nj({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:a,paneClickDistance:l,deleteKeyCode:s,selectionKeyCode:d,selectionOnDrag:c,selectionMode:u,onSelectionStart:h,onSelectionEnd:f,multiSelectionKeyCode:g,panActivationKeyCode:p,zoomActivationKeyCode:m,elementsSelectable:v,zoomOnScroll:b,zoomOnPinch:w,panOnScroll:S,panOnScrollSpeed:E,panOnScrollMode:M,zoomOnDoubleClick:C,panOnDrag:N,defaultViewport:k,translateExtent:j,minZoom:P,maxZoom:I,preventScrolling:A,onSelectionContextMenu:D,noWheelClassName:$,noPanClassName:z,disableKeyboardA11y:_,onViewportChange:L,isControlledViewport:R}){let{nodesSelectionActive:O,userSelectionActive:B}=tN(nk,tw),H=tG(d,{target:nN}),T=tG(p,{target:nN}),V=T||N,F=T||S,Z=c&&!0!==V,W=H||B||Z;return!function({deleteKeyCode:e,multiSelectionKeyCode:t}){let n=tk(),{deleteElements:o}=no(),r=tG(e,{actInsideInputWithModifier:!1}),i=tG(t,{target:ni});(0,y.useEffect)(()=>{if(r){let{edges:e,nodes:t}=n.getState();o({nodes:t.filter(nr),edges:e.filter(nr)}),n.setState({nodesSelectionActive:!1})}},[r]),(0,y.useEffect)(()=>{n.setState({multiSelectionActive:i})},[i])}({deleteKeyCode:s,multiSelectionKeyCode:g}),(0,x.jsx)(ns,{onPaneContextMenu:i,elementsSelectable:v,zoomOnScroll:b,zoomOnPinch:w,panOnScroll:F,panOnScrollSpeed:E,panOnScrollMode:M,zoomOnDoubleClick:C,panOnDrag:!H&&V,defaultViewport:k,translateExtent:j,minZoom:P,maxZoom:I,zoomActivationKeyCode:m,preventScrolling:A,noWheelClassName:$,noPanClassName:z,onViewportChange:L,isControlledViewport:R,paneClickDistance:l,selectionOnDrag:Z,children:(0,x.jsxs)(nf,{onSelectionStart:h,onSelectionEnd:f,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:a,panOnDrag:V,isSelecting:!!W,selectionMode:u,selectionKeyPressed:H,paneClickDistance:l,selectionOnDrag:Z,children:[e,O&&(0,x.jsx)(nC,{onSelectionContextMenu:D,noPanClassName:z,disableKeyboardA11y:_})]})})}nj.displayName="FlowRenderer";let nP=(0,y.memo)(nj),nI=e=>e.updateNodeInternals;var nA=(0,y.memo)(function({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:i,onDoubleClick:a,nodesDraggable:l,elementsSelectable:s,nodesConnectable:d,nodesFocusable:c,resizeObserver:u,noDragClassName:h,noPanClassName:f,disableKeyboardA11y:g,rfId:p,nodeTypes:m,nodeClickDistance:b,onError:w}){let S,{node:E,internals:M,isParent:C}=tN(t=>{let n=t.nodeLookup.get(e),o=t.parentLookup.has(e);return{node:n,internals:n.internals,isParent:o}},tw),N=E.type||"default",k=m?.[N]||nE[N];void 0===k&&(w?.("003",(S=N,`Node type "${S}" not found. Using fallback type "default".`)),N="default",k=m?.default||nE.default);let j=!!(E.draggable||l&&void 0===E.draggable),P=!!(E.selectable||s&&void 0===E.selectable),I=!!(E.connectable||d&&void 0===E.connectable),A=!!(E.focusable||c&&void 0===E.focusable),D=tk(),$=eb(E),z=function({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){let r=tk(),i=(0,y.useRef)(null),a=(0,y.useRef)(null),l=(0,y.useRef)(e.sourcePosition),s=(0,y.useRef)(e.targetPosition),d=(0,y.useRef)(t),c=n&&!!e.internals.handleBounds;return(0,y.useEffect)(()=>{!i.current||e.hidden||c&&a.current===i.current||(a.current&&o?.unobserve(a.current),o?.observe(i.current),a.current=i.current)},[c,e.hidden]),(0,y.useEffect)(()=>()=>{a.current&&(o?.unobserve(a.current),a.current=null)},[]),(0,y.useEffect)(()=>{if(i.current){let n=d.current!==t,o=l.current!==e.sourcePosition,a=s.current!==e.targetPosition;(n||o||a)&&(d.current=t,l.current=e.sourcePosition,s.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}({node:E,nodeType:N,hasDimensions:$,resizeObserver:u}),_=np({nodeRef:z,disabled:E.hidden||!j,noDragClassName:h,handleSelector:E.dragHandle,nodeId:e,isSelectable:P,nodeClickDistance:b}),L=nm();if(E.hidden)return null;let R=ev(E),B=void 0===E.internals.handleBounds?{width:E.width??E.initialWidth??E.style?.width,height:E.height??E.initialHeight??E.style?.height}:{width:E.width??E.style?.width,height:E.height??E.style?.height},H=P||j||t||n||o||r,T=n?e=>n(e,{...M.userNode}):void 0,V=o?e=>o(e,{...M.userNode}):void 0,F=r?e=>r(e,{...M.userNode}):void 0,Z=i?e=>i(e,{...M.userNode}):void 0,W=a?e=>a(e,{...M.userNode}):void 0;return(0,x.jsx)("div",{className:v(["react-flow__node",`react-flow__node-${N}`,{[f]:j},E.className,{selected:E.selected,selectable:P,parent:C,draggable:j,dragging:_}]),ref:z,style:{zIndex:M.z,transform:`translate(${M.positionAbsolute.x}px,${M.positionAbsolute.y}px)`,pointerEvents:H?"all":"none",visibility:$?"visible":"hidden",...E.style,...B},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:T,onMouseMove:V,onMouseLeave:F,onContextMenu:Z,onClick:n=>{let{selectNodesOnDrag:o,nodeDragThreshold:r}=D.getState();P&&(!o||!j||r>0)&&ng({id:e,store:D,nodeRef:z}),t&&t(n,{...M.userNode})},onDoubleClick:W,onKeyDown:A?t=>{if(!ek(t.nativeEvent)&&!g){if(O.includes(t.key)&&P)ng({id:e,store:D,unselect:"Escape"===t.key,nodeRef:z});else if(j&&E.selected&&Object.prototype.hasOwnProperty.call(nS,t.key)){t.preventDefault();let{ariaLabelConfig:e}=D.getState();D.setState({ariaLiveMessage:e["node.a11yDescription.ariaLiveMessage"]({direction:t.key.replace("Arrow","").toLowerCase(),x:~~M.positionAbsolute.x,y:~~M.positionAbsolute.y})}),L({direction:nS[t.key],factor:t.shiftKey?4:1})}}}:void 0,tabIndex:A?0:void 0,onFocus:A?()=>{if(g||!z.current?.matches(":focus-visible"))return;let{transform:t,width:n,height:o,autoPanOnNodeFocus:r,setCenter:i}=D.getState();!r||K(new Map([[e,E]]),{x:0,y:0,width:n,height:o},t,!0).length>0||i(E.position.x+R.width/2,E.position.y+R.height/2,{zoom:t[2]})}:void 0,role:E.ariaRole??(A?"group":void 0),"aria-roledescription":"node","aria-describedby":g?void 0:`${tI}-${p}`,"aria-label":E.ariaLabel,...E.domAttributes,children:(0,x.jsx)(ny,{value:e,children:(0,x.jsx)(k,{id:e,data:E.data,type:N,positionAbsoluteX:M.positionAbsolute.x,positionAbsoluteY:M.positionAbsolute.y,selected:E.selected??!1,selectable:P,draggable:j,deletable:E.deletable??!0,isConnectable:I,sourcePosition:E.sourcePosition,targetPosition:E.targetPosition,dragging:_,dragHandle:E.dragHandle,zIndex:M.z,parentId:E.parentId,...R})})})});let nD=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function n$(e){var t;let{nodesDraggable:n,nodesConnectable:o,nodesFocusable:r,elementsSelectable:i,onError:a}=tN(nD,tw),l=(t=e.onlyRenderVisibleElements,tN((0,y.useCallback)(e=>t?K(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(e=>e.id):Array.from(e.nodeLookup.keys()),[t]),tw)),s=function(){let e=tN(nI),[t]=(0,y.useState)(()=>"u"<typeof ResizeObserver?null:new ResizeObserver(t=>{let n=new Map;t.forEach(e=>{let t=e.target.getAttribute("data-id");n.set(t,{id:t,nodeElement:e.target,force:!0})}),e(n)}));return(0,y.useEffect)(()=>()=>{t?.disconnect()},[t]),t}();return(0,x.jsx)("div",{className:"react-flow__nodes",style:na,children:l.map(t=>(0,x.jsx)(nA,{id:t,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:n,nodesConnectable:o,nodesFocusable:r,elementsSelectable:i,nodeClickDistance:e.nodeClickDistance,onError:a},t))})}n$.displayName="NodeRenderer";let nz=(0,y.memo)(n$),n_={[f.Arrow]:({color:e="none",strokeWidth:t=1})=>{let n={strokeWidth:t,...e&&{stroke:e}};return(0,x.jsx)("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},[f.ArrowClosed]:({color:e="none",strokeWidth:t=1})=>{let n={strokeWidth:t,...e&&{stroke:e,fill:e}};return(0,x.jsx)("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}},nL=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:a,orient:l="auto-start-reverse"})=>{let s,d=(s=tk(),(0,y.useMemo)(()=>{let e;return Object.prototype.hasOwnProperty.call(n_,t)?n_[t]:(s.getState().onError?.("009",(e=t,`Marker type "${e}" doesn't exist.`)),null)},[t]));return d?(0,x.jsx)("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:l,refX:"0",refY:"0",children:(0,x.jsx)(d,{color:n,strokeWidth:a})}):null},nR=({defaultColor:e,rfId:t})=>{let n=tN(e=>e.edges),o=tN(e=>e.defaultEdgeOptions),r=(0,y.useMemo)(()=>(function(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){let i=new Set;return e.reduce((e,a)=>([a.markerStart||o,a.markerEnd||r].forEach(o=>{if(o&&"object"==typeof o){let r=eW(o,t);i.has(r)||(e.push({id:r,color:o.color||n,...o}),i.add(r))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))})(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return r.length?(0,x.jsx)("svg",{className:"react-flow__marker","aria-hidden":"true",children:(0,x.jsx)("defs",{children:r.map(e=>(0,x.jsx)(nL,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id))})}):null};nR.displayName="MarkerDefinitions";var nO=(0,y.memo)(nR);function nB({x:e,y:t,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:i,labelBgPadding:a=[2,4],labelBgBorderRadius:l=2,children:s,className:d,...c}){let[u,h]=(0,y.useState)({x:1,y:0,width:0,height:0}),f=v(["react-flow__edge-textwrapper",d]),g=(0,y.useRef)(null);return((0,y.useEffect)(()=>{if(g.current){let e=g.current.getBBox();h({x:e.x,y:e.y,width:e.width,height:e.height})}},[n]),n)?(0,x.jsxs)("g",{transform:`translate(${e-u.width/2} ${t-u.height/2})`,className:f,visibility:u.width?"visible":"hidden",...c,children:[r&&(0,x.jsx)("rect",{width:u.width+2*a[0],x:-a[0],y:-a[1],height:u.height+2*a[1],className:"react-flow__edge-textbg",style:i,rx:l,ry:l}),(0,x.jsx)("text",{className:"react-flow__edge-text",y:u.height/2,dy:"0.3em",ref:g,style:o,children:n}),s]}):null}nB.displayName="EdgeText";let nH=(0,y.memo)(nB);function nT({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:s,interactionWidth:d=20,...c}){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("path",{...c,d:e,fill:"none",className:v(["react-flow__edge-path",c.className])}),d?(0,x.jsx)("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:d,className:"react-flow__edge-interaction"}):null,o&&ec(t)&&ec(n)?(0,x.jsx)(nH,{x:t,y:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:s}):null]})}function nV({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===g.Left||e===g.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function nF({sourceX:e,sourceY:t,sourcePosition:n=g.Bottom,targetX:o,targetY:r,targetPosition:i=g.Top}){let[a,l]=nV({pos:n,x1:e,y1:t,x2:o,y2:r}),[s,d]=nV({pos:i,x1:o,y1:r,x2:e,y2:t}),[c,u,h,f]=eI({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:s,targetControlY:d});return[`M${e},${t} C${a},${l} ${s},${d} ${o},${r}`,c,u,h,f]}function nZ(e){return(0,y.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:a,targetPosition:l,label:s,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:f,style:g,markerEnd:p,markerStart:m,interactionWidth:y})=>{let[v,b,w]=nF({sourceX:n,sourceY:o,sourcePosition:a,targetX:r,targetY:i,targetPosition:l}),S=e.isInternal?void 0:t;return(0,x.jsx)(nT,{id:S,path:v,labelX:b,labelY:w,label:s,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:f,style:g,markerEnd:p,markerStart:m,interactionWidth:y})})}let nW=nZ({isInternal:!1}),nX=nZ({isInternal:!0});function nK(e){return(0,y.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:a,labelStyle:l,labelShowBg:s,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:u,style:h,sourcePosition:f=g.Bottom,targetPosition:p=g.Top,markerEnd:m,markerStart:y,pathOptions:v,interactionWidth:b})=>{let[w,S,E]=eH({sourceX:n,sourceY:o,sourcePosition:f,targetX:r,targetY:i,targetPosition:p,borderRadius:v?.borderRadius,offset:v?.offset,stepPosition:v?.stepPosition}),M=e.isInternal?void 0:t;return(0,x.jsx)(nT,{id:M,path:w,labelX:S,labelY:E,label:a,labelStyle:l,labelShowBg:s,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:u,style:h,markerEnd:m,markerStart:y,interactionWidth:b})})}nW.displayName="SimpleBezierEdge",nX.displayName="SimpleBezierEdgeInternal";let nY=nK({isInternal:!1}),nU=nK({isInternal:!0});function nq(e){return(0,y.memo)(({id:t,...n})=>{let o=e.isInternal?void 0:t;return(0,x.jsx)(nY,{...n,id:o,pathOptions:(0,y.useMemo)(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}nY.displayName="SmoothStepEdge",nU.displayName="SmoothStepEdgeInternal";let nQ=nq({isInternal:!1}),nG=nq({isInternal:!0});function nJ(e){return(0,y.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:a,labelStyle:l,labelShowBg:s,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:g,interactionWidth:p})=>{let[m,y,v]=eL({sourceX:n,sourceY:o,targetX:r,targetY:i}),b=e.isInternal?void 0:t;return(0,x.jsx)(nT,{id:b,path:m,labelX:y,labelY:v,label:a,labelStyle:l,labelShowBg:s,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:g,interactionWidth:p})})}nQ.displayName="StepEdge",nG.displayName="StepEdgeInternal";let n0=nJ({isInternal:!1}),n1=nJ({isInternal:!0});function n2(e){return(0,y.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:a=g.Bottom,targetPosition:l=g.Top,label:s,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:m,markerStart:y,pathOptions:v,interactionWidth:b})=>{let[w,S,E]=e$({sourceX:n,sourceY:o,sourcePosition:a,targetX:r,targetY:i,targetPosition:l,curvature:v?.curvature}),M=e.isInternal?void 0:t;return(0,x.jsx)(nT,{id:M,path:w,labelX:S,labelY:E,label:s,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:m,markerStart:y,interactionWidth:b})})}n0.displayName="StraightEdge",n1.displayName="StraightEdgeInternal";let n3=n2({isInternal:!1}),n4=n2({isInternal:!0});n3.displayName="BezierEdge",n4.displayName="BezierEdgeInternal";let n5={default:n4,straight:n1,step:nG,smoothstep:nU,simplebezier:nX},n6={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},n8="react-flow__edgeupdater";function n7({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:i,onMouseOut:a,type:l}){return(0,x.jsx)("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:a,className:v([n8,`${n8}-${l}`]),cx:e===g.Left?t-o:e===g.Right?t+o:t,cy:e===g.Top?n-o:e===g.Bottom?n+o:n,r:o,stroke:"transparent",fill:"transparent"})}function n9({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:i,targetY:a,sourcePosition:l,targetPosition:s,onReconnect:d,onReconnectStart:c,onReconnectEnd:u,setReconnecting:h,setUpdateHover:f}){let g=tk(),p=(e,t)=>{if(0!==e.button)return;let{autoPanOnConnect:o,domNode:r,isValidConnection:i,connectionMode:a,connectionRadius:l,lib:s,onConnectStart:f,onConnectEnd:p,cancelConnection:m,nodeLookup:x,rfId:y,panBy:v,updateConnection:b}=g.getState(),w="target"===t.type;e9(e.nativeEvent,{autoPanOnConnect:o,connectionMode:a,connectionRadius:l,domNode:r,handleId:t.id,nodeId:t.nodeId,nodeLookup:x,isTarget:w,edgeUpdaterType:t.type,lib:s,flowId:y,cancelConnection:m,panBy:v,isValidConnection:i,onConnect:e=>d?.(n,e),onConnectStart:(o,r)=>{h(!0),c?.(e,n,t.type),f?.(o,r)},onConnectEnd:p,onReconnectEnd:(e,o)=>{h(!1),u?.(e,n,t.type,o)},updateConnection:b,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,dragThreshold:g.getState().connectionDragThreshold,handleDomNode:e.currentTarget})},m=()=>f(!0),y=()=>f(!1);return(0,x.jsxs)(x.Fragment,{children:[(!0===e||"source"===e)&&(0,x.jsx)(n7,{position:l,centerX:o,centerY:r,radius:t,onMouseDown:e=>p(e,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),onMouseEnter:m,onMouseOut:y,type:"source"}),(!0===e||"target"===e)&&(0,x.jsx)(n7,{position:s,centerX:i,centerY:a,radius:t,onMouseDown:e=>p(e,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),onMouseEnter:m,onMouseOut:y,type:"target"})]})}var oe=(0,y.memo)(function({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:i,onContextMenu:a,onMouseEnter:l,onMouseMove:s,onMouseLeave:c,reconnectRadius:u,onReconnect:h,onReconnectStart:f,onReconnectEnd:p,rfId:m,edgeTypes:b,noPanClassName:w,onError:S,disableKeyboardA11y:E}){let M,C=tN(t=>t.edgeLookup.get(e)),N=tN(e=>e.defaultEdgeOptions),k=(C=N?{...N,...C}:C).type||"default",j=b?.[k]||n5[k];void 0===j&&(S?.("011",(M=k,`Edge type "${M}" not found. Using fallback type "default".`)),k="default",j=b?.default||n5.default);let P=!!(C.focusable||t&&void 0===C.focusable),I=void 0!==h&&(C.reconnectable||n&&void 0===C.reconnectable),A=!!(C.selectable||o&&void 0===C.selectable),D=(0,y.useRef)(null),[$,z]=(0,y.useState)(!1),[_,L]=(0,y.useState)(!1),R=tk(),{zIndex:B,sourceX:H,sourceY:T,targetX:V,targetY:F,sourcePosition:Z,targetPosition:W}=tN((0,y.useCallback)(t=>{let n=t.nodeLookup.get(C.source),o=t.nodeLookup.get(C.target);if(!n||!o)return{zIndex:C.zIndex,...n6};let r=function(e){let{sourceNode:t,targetNode:n}=e;if(!eT(t)||!eT(n))return null;let o=t.internals.handleBounds||eV(t.handles),r=n.internals.handleBounds||eV(n.handles),i=eZ(o?.source??[],e.sourceHandle),a=eZ(e.connectionMode===d.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!a)return e.onError?.("008",((e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${"source"===e?n:o}", edge id: ${t}.`)(!i?"source":"target",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;let l=i?.position||g.Bottom,s=a?.position||g.Top,c=eF(t,i,l),u=eF(n,a,s);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:l,targetPosition:s}}({id:e,sourceNode:n,targetNode:o,sourceHandle:C.sourceHandle||null,targetHandle:C.targetHandle||null,connectionMode:t.connectionMode,onError:S});return{zIndex:function({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1,zIndexMode:i="basic"}){if("manual"===i)return o;let a=Math.max(e.parentId||r&&e.selected?e.internals.z:0,t.parentId||r&&t.selected?t.internals.z:0);return(r&&n?o+1e3:o)+a}({selected:C.selected,zIndex:C.zIndex,sourceNode:n,targetNode:o,elevateOnSelect:t.elevateEdgesOnSelect,zIndexMode:t.zIndexMode}),...r||n6}},[C.source,C.target,C.sourceHandle,C.targetHandle,C.selected,C.zIndex]),tw),X=(0,y.useMemo)(()=>C.markerStart?`url('#${eW(C.markerStart,m)}')`:void 0,[C.markerStart,m]),K=(0,y.useMemo)(()=>C.markerEnd?`url('#${eW(C.markerEnd,m)}')`:void 0,[C.markerEnd,m]);if(C.hidden||null===H||null===T||null===V||null===F)return null;let Y=i?e=>{i(e,{...C})}:void 0,U=a?e=>{a(e,{...C})}:void 0,q=l?e=>{l(e,{...C})}:void 0,Q=s?e=>{s(e,{...C})}:void 0,G=c?e=>{c(e,{...C})}:void 0;return(0,x.jsx)("svg",{style:{zIndex:B},children:(0,x.jsxs)("g",{className:v(["react-flow__edge",`react-flow__edge-${k}`,C.className,w,{selected:C.selected,animated:C.animated,inactive:!A&&!r,updating:$,selectable:A}]),onClick:t=>{let{addSelectedEdges:n,unselectNodesAndEdges:o,multiSelectionActive:i}=R.getState();A&&(R.setState({nodesSelectionActive:!1}),C.selected&&i?(o({nodes:[],edges:[C]}),D.current?.blur()):n([e])),r&&r(t,C)},onDoubleClick:Y,onContextMenu:U,onMouseEnter:q,onMouseMove:Q,onMouseLeave:G,onKeyDown:P?t=>{if(!E&&O.includes(t.key)&&A){let{unselectNodesAndEdges:n,addSelectedEdges:o}=R.getState();"Escape"===t.key?(D.current?.blur(),n({edges:[C]})):o([e])}}:void 0,tabIndex:P?0:void 0,role:C.ariaRole??(P?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":null===C.ariaLabel?void 0:C.ariaLabel||`Edge from ${C.source} to ${C.target}`,"aria-describedby":P?`${tA}-${m}`:void 0,ref:D,...C.domAttributes,children:[!_&&(0,x.jsx)(j,{id:e,source:C.source,target:C.target,type:C.type,selected:C.selected,animated:C.animated,selectable:A,deletable:C.deletable??!0,label:C.label,labelStyle:C.labelStyle,labelShowBg:C.labelShowBg,labelBgStyle:C.labelBgStyle,labelBgPadding:C.labelBgPadding,labelBgBorderRadius:C.labelBgBorderRadius,sourceX:H,sourceY:T,targetX:V,targetY:F,sourcePosition:Z,targetPosition:W,data:C.data,style:C.style,sourceHandleId:C.sourceHandle,targetHandleId:C.targetHandle,markerStart:X,markerEnd:K,pathOptions:"pathOptions"in C?C.pathOptions:void 0,interactionWidth:C.interactionWidth}),I&&(0,x.jsx)(n9,{edge:C,isReconnectable:I,reconnectRadius:u,onReconnect:h,onReconnectStart:f,onReconnectEnd:p,sourceX:H,sourceY:T,targetX:V,targetY:F,sourcePosition:Z,targetPosition:W,setUpdateHover:z,setReconnecting:L})]})})});let ot=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function on({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:i,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:s,onEdgeMouseLeave:d,onEdgeClick:c,reconnectRadius:u,onEdgeDoubleClick:h,onReconnectStart:f,onReconnectEnd:g,disableKeyboardA11y:p}){let{edgesFocusable:m,edgesReconnectable:v,elementsSelectable:b,onError:w}=tN(ot,tw),S=tN((0,y.useCallback)(e=>{if(!t)return e.edges.map(e=>e.id);let n=[];if(e.width&&e.height)for(let t of e.edges){let o=e.nodeLookup.get(t.source),r=e.nodeLookup.get(t.target);o&&r&&function({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){let i=en(ea(e),ea(t));return i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1),es({x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]},er(i))>0}({sourceNode:o,targetNode:r,width:e.width,height:e.height,transform:e.transform})&&n.push(t.id)}return n},[t]),tw);return(0,x.jsxs)("div",{className:"react-flow__edges",children:[(0,x.jsx)(nO,{defaultColor:e,rfId:n}),S.map(e=>(0,x.jsx)(oe,{id:e,edgesFocusable:m,edgesReconnectable:v,elementsSelectable:b,noPanClassName:r,onReconnect:i,onContextMenu:a,onMouseEnter:l,onMouseMove:s,onMouseLeave:d,onClick:c,reconnectRadius:u,onDoubleClick:h,onReconnectStart:f,onReconnectEnd:g,rfId:n,onError:w,edgeTypes:o,disableKeyboardA11y:p},e))]})}on.displayName="EdgeRenderer";let oo=(0,y.memo)(on),or=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function oi({children:e}){let t=tN(or);return(0,x.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}let oa=e=>e.panZoom?.syncViewport;function ol(e){return e.connection.inProgress?{...e.connection,to:ef(e.connection.to,e.transform)}:{...e.connection}}let os=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function od({containerStyle:e,style:t,type:n,component:o}){let{nodesConnectable:r,width:i,height:a,isValid:l,inProgress:s}=tN(os,tw);return i&&r&&s?(0,x.jsx)("svg",{style:e,width:i,height:a,className:"react-flow__connectionline react-flow__container",children:(0,x.jsx)("g",{className:v(["react-flow__connection",V(l)]),children:(0,x.jsx)(oc,{style:t,type:n,CustomComponent:o,isValid:l})})}):null}let oc=({style:e,type:t=h.Bezier,CustomComponent:n,isValid:o})=>{let{inProgress:r,from:i,fromNode:a,fromHandle:l,fromPosition:s,to:d,toNode:c,toHandle:u,toPosition:f,pointer:g}=tN(ol,tw);if(!r)return;if(n)return(0,x.jsx)(n,{connectionLineType:t,connectionLineStyle:e,fromNode:a,fromHandle:l,fromX:i.x,fromY:i.y,toX:d.x,toY:d.y,fromPosition:s,toPosition:f,connectionStatus:V(o),toNode:c,toHandle:u,pointer:g});let p="",m={sourceX:i.x,sourceY:i.y,sourcePosition:s,targetX:d.x,targetY:d.y,targetPosition:f};switch(t){case h.Bezier:[p]=e$(m);break;case h.SimpleBezier:[p]=nF(m);break;case h.Step:[p]=eH({...m,borderRadius:0});break;case h.SmoothStep:[p]=eH(m);break;default:[p]=eL(m)}return(0,x.jsx)("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};oc.displayName="ConnectionLine";let ou={};function oh(e=ou){(0,y.useRef)(e),tk(),(0,y.useEffect)(()=>{},[e])}function of({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:a,onNodeMouseEnter:l,onNodeMouseMove:s,onNodeMouseLeave:d,onNodeContextMenu:c,onSelectionContextMenu:u,onSelectionStart:h,onSelectionEnd:f,connectionLineType:g,connectionLineStyle:p,connectionLineComponent:m,connectionLineContainerStyle:v,selectionKeyCode:b,selectionOnDrag:w,selectionMode:S,multiSelectionKeyCode:E,panActivationKeyCode:M,zoomActivationKeyCode:C,deleteKeyCode:N,onlyRenderVisibleElements:k,elementsSelectable:j,defaultViewport:P,translateExtent:I,minZoom:A,maxZoom:D,preventScrolling:$,defaultMarkerColor:z,zoomOnScroll:_,zoomOnPinch:L,panOnScroll:R,panOnScrollSpeed:O,panOnScrollMode:B,zoomOnDoubleClick:H,panOnDrag:T,onPaneClick:V,onPaneMouseEnter:F,onPaneMouseMove:Z,onPaneMouseLeave:W,onPaneScroll:X,onPaneContextMenu:K,paneClickDistance:Y,nodeClickDistance:U,onEdgeContextMenu:q,onEdgeMouseEnter:Q,onEdgeMouseMove:G,onEdgeMouseLeave:J,reconnectRadius:ee,onReconnect:et,onReconnectStart:en,onReconnectEnd:eo,noDragClassName:er,noWheelClassName:ei,noPanClassName:ea,disableKeyboardA11y:el,nodeExtent:es,rfId:ed,viewport:ec,onViewportChange:eu}){let eh,ef,eg,ep;return oh(e),oh(t),tk(),(0,y.useRef)(!1),(0,y.useEffect)(()=>{},[]),eh=no(),ef=(0,y.useRef)(!1),(0,y.useEffect)(()=>{!ef.current&&eh.viewportInitialized&&n&&(setTimeout(()=>n(eh),1),ef.current=!0)},[n,eh.viewportInitialized]),eg=tN(oa),ep=tk(),(0,y.useEffect)(()=>{ec&&(eg?.(ec),ep.setState({transform:[ec.x,ec.y,ec.zoom]}))},[ec,eg]),(0,x.jsx)(nP,{onPaneClick:V,onPaneMouseEnter:F,onPaneMouseMove:Z,onPaneMouseLeave:W,onPaneContextMenu:K,onPaneScroll:X,paneClickDistance:Y,deleteKeyCode:N,selectionKeyCode:b,selectionOnDrag:w,selectionMode:S,onSelectionStart:h,onSelectionEnd:f,multiSelectionKeyCode:E,panActivationKeyCode:M,zoomActivationKeyCode:C,elementsSelectable:j,zoomOnScroll:_,zoomOnPinch:L,zoomOnDoubleClick:H,panOnScroll:R,panOnScrollSpeed:O,panOnScrollMode:B,panOnDrag:T,defaultViewport:P,translateExtent:I,minZoom:A,maxZoom:D,onSelectionContextMenu:u,preventScrolling:$,noDragClassName:er,noWheelClassName:ei,noPanClassName:ea,disableKeyboardA11y:el,onViewportChange:eu,isControlledViewport:!!ec,children:(0,x.jsxs)(oi,{children:[(0,x.jsx)(oo,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:a,onReconnect:et,onReconnectStart:en,onReconnectEnd:eo,onlyRenderVisibleElements:k,onEdgeContextMenu:q,onEdgeMouseEnter:Q,onEdgeMouseMove:G,onEdgeMouseLeave:J,reconnectRadius:ee,defaultMarkerColor:z,noPanClassName:ea,disableKeyboardA11y:el,rfId:ed}),(0,x.jsx)(od,{style:p,type:g,component:m,containerStyle:v}),(0,x.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,x.jsx)(nz,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:i,onNodeMouseEnter:l,onNodeMouseMove:s,onNodeMouseLeave:d,onNodeContextMenu:c,nodeClickDistance:U,onlyRenderVisibleElements:k,noPanClassName:ea,noDragClassName:er,disableKeyboardA11y:el,nodeExtent:es,rfId:ed}),(0,x.jsx)("div",{className:"react-flow__viewport-portal"})]})})}of.displayName="GraphView";let og=(0,y.memo)(of),op=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:a,fitViewOptions:l,minZoom:s=.5,maxZoom:c=2,nodeOrigin:u,nodeExtent:h,zIndexMode:f="basic"}={})=>{let g=new Map,p=new Map,m=new Map,x=new Map,y=o??t??[],v=n??e??[],b=u??[0,0],w=h??R;e2(m,x,y);let S=eq(v,g,p,{nodeOrigin:b,nodeExtent:w,zIndexMode:f}),E=[0,0,1];if(a&&r&&i){let{x:e,y:t,zoom:n}=em(X(g,{filter:e=>!!((e.width||e.initialWidth)&&(e.height||e.initialHeight))}),r,i,s,c,l?.padding??.1);E=[e,t,n]}return{rfId:"1",width:r??0,height:i??0,transform:E,nodes:v,nodesInitialized:S,nodeLookup:g,parentLookup:p,edges:y,edgeLookup:x,connectionLookup:m,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:void 0!==n,hasDefaultEdges:void 0!==o,panZoom:null,minZoom:s,maxZoom:c,translateExtent:R,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:d.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:b,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:a??!1,fitViewOptions:l,fitViewResolver:null,connection:{...H},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:eu,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:B,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}};function om({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:i,initialMinZoom:a,initialMaxZoom:l,initialFitViewOptions:s,fitView:d,nodeOrigin:c,nodeExtent:u,zIndexMode:h,children:f}){let[p]=(0,y.useState)(()=>(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:a,fitViewOptions:l,minZoom:s,maxZoom:d,nodeOrigin:c,nodeExtent:u,zIndexMode:h})=>{let f,p;return f=(f,p)=>{async function m(){let{nodeLookup:e,panZoom:t,fitViewOptions:n,fitViewResolver:o,width:r,height:i,minZoom:a,maxZoom:l}=p();t&&(await Y({nodes:e,width:r,height:i,panZoom:t,minZoom:a,maxZoom:l},n),o?.resolve(!0),f({fitViewResolver:null}))}return{...op({nodes:e,edges:t,width:r,height:i,fitView:a,fitViewOptions:l,minZoom:s,maxZoom:d,nodeOrigin:c,nodeExtent:u,defaultNodes:n,defaultEdges:o,zIndexMode:h}),setNodes:e=>{let{nodeLookup:t,parentLookup:n,nodeOrigin:o,elevateNodesOnSelect:r,fitViewQueued:i,zIndexMode:a}=p(),l=eq(e,t,n,{nodeOrigin:o,nodeExtent:u,elevateNodesOnSelect:r,checkEquality:!0,zIndexMode:a});i&&l?(m(),f({nodes:e,nodesInitialized:l,fitViewQueued:!1,fitViewOptions:void 0})):f({nodes:e,nodesInitialized:l})},setEdges:e=>{let{connectionLookup:t,edgeLookup:n}=p();e2(t,n,e),f({edges:e})},setDefaultNodesAndEdges:(e,t)=>{if(e){let{setNodes:t}=p();t(e),f({hasDefaultNodes:!0})}if(t){let{setEdges:e}=p();e(t),f({hasDefaultEdges:!0})}},updateNodeInternals:e=>{let{triggerNodeChanges:t,nodeLookup:n,parentLookup:o,domNode:r,nodeOrigin:i,nodeExtent:a,debug:l,fitViewQueued:s,zIndexMode:d}=p(),{changes:c,updatedInternals:u}=function(e,t,n,o,r,i,a){let l=o?.querySelector(".xyflow__viewport"),s=!1;if(!l)return{changes:[],updatedInternals:s};let d=[],c=window.getComputedStyle(l),{m22:u}=new window.DOMMatrixReadOnly(c.transform),h=[];for(let o of e.values()){let e=t.get(o.id);if(!e)continue;if(e.hidden){t.set(e.id,{...e,internals:{...e.internals,handleBounds:void 0}}),s=!0;continue}let l=eM(o.nodeElement),c=e.measured.width!==l.width||e.measured.height!==l.height;if(l.width&&l.height&&(c||!e.internals.handleBounds||o.force)){let f=o.nodeElement.getBoundingClientRect(),g=ey(e.extent)?e.extent:i,{positionAbsolute:p}=e.internals;e.parentId&&"parent"===e.extent?p=J(p,l,t.get(e.parentId)):g&&(p=G(p,g,l));let m={...e,measured:l,internals:{...e.internals,positionAbsolute:p,handleBounds:{source:eP("source",o.nodeElement,f,u,e.id),target:eP("target",o.nodeElement,f,u,e.id)}}};t.set(e.id,m),e.parentId&&eQ(m,t,n,{nodeOrigin:r,zIndexMode:a}),s=!0,c&&(d.push({id:e.id,type:"dimensions",dimensions:l}),e.expandParent&&e.parentId&&h.push({id:e.id,parentId:e.parentId,rect:ei(m,r)}))}}if(h.length>0){let e=eJ(h,t,n,r);d.push(...e)}return{changes:d,updatedInternals:s}}(e,n,o,r,i,a,d);u&&(!function(e,t,n){let o=eY(eX,n);for(let n of e.values())if(n.parentId)eQ(n,e,t,o);else{let e=G(W(n,o.nodeOrigin),ey(n.extent)?n.extent:o.nodeExtent,ev(n));n.internals.positionAbsolute=e}}(n,o,{nodeOrigin:i,nodeExtent:a,zIndexMode:d}),s?(m(),f({fitViewQueued:!1,fitViewOptions:void 0})):f({}),c?.length>0&&(l&&console.log("React Flow: trigger node changes",c),t?.(c)))},updateNodePositions:(e,t=!1)=>{let n=[],o=[],{nodeLookup:r,triggerNodeChanges:i,connection:a,updateConnection:l,onNodesChangeMiddlewareMap:s}=p();for(let[i,s]of e){let e=r.get(i),d=!!(e?.expandParent&&e?.parentId&&s?.position),c={id:i,type:"position",position:d?{x:Math.max(0,s.position.x),y:Math.max(0,s.position.y)}:s.position,dragging:t};if(e&&a.inProgress&&a.fromNode.id===e.id){let t=eF(e,a.fromHandle,g.Left,!0);l({...a,from:t})}d&&e.parentId&&n.push({id:i,parentId:e.parentId,rect:{...s.internals.positionAbsolute,width:s.measured.width??0,height:s.measured.height??0}}),o.push(c)}if(n.length>0){let{parentLookup:e,nodeOrigin:t}=p(),i=eJ(n,r,e,t);o.push(...i)}for(let e of s.values())o=e(o);i(o)},triggerNodeChanges:e=>{let{onNodesChange:t,setNodes:n,nodes:o,hasDefaultNodes:r,debug:i}=p();e?.length&&(r&&n(t1(e,o)),i&&console.log("React Flow: trigger node changes",e),t?.(e))},triggerEdgeChanges:e=>{let{onEdgesChange:t,setEdges:n,edges:o,hasDefaultEdges:r,debug:i}=p();e?.length&&(r&&n(t1(e,o)),i&&console.log("React Flow: trigger edge changes",e),t?.(e))},addSelectedNodes:e=>{let{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:r,triggerEdgeChanges:i}=p();t?r(e.map(e=>t2(e,!0))):(r(t3(o,new Set([...e]),!0)),i(t3(n)))},addSelectedEdges:e=>{let{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:r,triggerEdgeChanges:i}=p();t?i(e.map(e=>t2(e,!0))):(i(t3(n,new Set([...e]))),r(t3(o,new Set,!0)))},unselectNodesAndEdges:({nodes:e,edges:t}={})=>{let{edges:n,nodes:o,nodeLookup:r,triggerNodeChanges:i,triggerEdgeChanges:a}=p(),l=(e||o).map(e=>{let t=r.get(e.id);return t&&(t.selected=!1),t2(e.id,!1)}),s=(t||n).map(e=>t2(e.id,!1));i(l),a(s)},setMinZoom:e=>{let{panZoom:t,maxZoom:n}=p();t?.setScaleExtent([e,n]),f({minZoom:e})},setMaxZoom:e=>{let{panZoom:t,minZoom:n}=p();t?.setScaleExtent([n,e]),f({maxZoom:e})},setTranslateExtent:e=>{p().panZoom?.setTranslateExtent(e),f({translateExtent:e})},resetSelectedElements:()=>{let{edges:e,nodes:t,triggerNodeChanges:n,triggerEdgeChanges:o,elementsSelectable:r}=p();if(!r)return;let i=t.reduce((e,t)=>t.selected?[...e,t2(t.id,!1)]:e,[]),a=e.reduce((e,t)=>t.selected?[...e,t2(t.id,!1)]:e,[]);n(i),o(a)},setNodeExtent:e=>{let{nodes:t,nodeLookup:n,parentLookup:o,nodeOrigin:r,elevateNodesOnSelect:i,nodeExtent:a,zIndexMode:l}=p();(e[0][0]!==a[0][0]||e[0][1]!==a[0][1]||e[1][0]!==a[1][0]||e[1][1]!==a[1][1])&&(eq(t,n,o,{nodeOrigin:r,nodeExtent:e,elevateNodesOnSelect:i,checkEquality:!1,zIndexMode:l}),f({nodeExtent:e}))},panBy:e=>{let{transform:t,width:n,height:o,panZoom:r,translateExtent:i}=p();return e0({delta:e,panZoom:r,transform:t,translateExtent:i,width:n,height:o})},setCenter:async(e,t,n)=>{let{width:o,height:r,maxZoom:i,panZoom:a}=p();if(!a)return Promise.resolve(!1);let l=void 0!==n?.zoom?n.zoom:i;return await a.setViewport({x:o/2-e*l,y:r/2-t*l,zoom:l},{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{f({connection:{...H}})},updateConnection:e=>{f({connection:e})},reset:()=>f({...op()})}},p=Object.is,f?tb(f,p):tb})({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:d,minZoom:a,maxZoom:l,fitViewOptions:s,nodeOrigin:c,nodeExtent:u,zIndexMode:h}));return(0,x.jsx)(tM,{value:p,children:(0,x.jsx)(nt,{children:f})})}function ox({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:i,height:a,fitView:l,fitViewOptions:s,minZoom:d,maxZoom:c,nodeOrigin:u,nodeExtent:h,zIndexMode:f}){return(0,y.useContext)(tE)?(0,x.jsx)(x.Fragment,{children:e}):(0,x.jsx)(om,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:i,initialHeight:a,fitView:l,initialFitViewOptions:s,initialMinZoom:d,initialMaxZoom:c,nodeOrigin:u,nodeExtent:h,zIndexMode:f,children:e})}let oy={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};var ov=t8(function({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:i,edgeTypes:a,onNodeClick:l,onEdgeClick:s,onInit:d,onMove:f,onMoveStart:g,onMoveEnd:p,onConnect:m,onConnectStart:b,onConnectEnd:w,onClickConnectStart:S,onClickConnectEnd:E,onNodeMouseEnter:M,onNodeMouseMove:C,onNodeMouseLeave:N,onNodeContextMenu:k,onNodeDoubleClick:j,onNodeDragStart:P,onNodeDrag:I,onNodeDragStop:A,onNodesDelete:D,onEdgesDelete:$,onDelete:z,onSelectionChange:_,onSelectionDragStart:L,onSelectionDrag:O,onSelectionDragStop:B,onSelectionContextMenu:H,onSelectionStart:T,onSelectionEnd:V,onBeforeDelete:F,connectionMode:Z,connectionLineType:W=h.Bezier,connectionLineStyle:X,connectionLineComponent:K,connectionLineContainerStyle:Y,deleteKeyCode:U="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:Q=!1,selectionMode:G=u.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:ee=ex()?"Meta":"Control",zoomActivationKeyCode:et=ex()?"Meta":"Control",snapToGrid:en,snapGrid:eo,onlyRenderVisibleElements:er=!1,selectNodesOnDrag:ei,nodesDraggable:ea,autoPanOnNodeFocus:el,nodesConnectable:es,nodesFocusable:ed,nodeOrigin:ec=tZ,edgesFocusable:eu,edgesReconnectable:eh,elementsSelectable:ef=!0,defaultViewport:eg=tW,minZoom:ep=.5,maxZoom:em=2,translateExtent:ey=R,preventScrolling:ev=!0,nodeExtent:eb,defaultMarkerColor:ew="#b1b1b7",zoomOnScroll:eS=!0,zoomOnPinch:eE=!0,panOnScroll:eM=!1,panOnScrollSpeed:eC=.5,panOnScrollMode:eN=c.Free,zoomOnDoubleClick:ek=!0,panOnDrag:ej=!0,onPaneClick:eP,onPaneMouseEnter:eI,onPaneMouseMove:eA,onPaneMouseLeave:eD,onPaneScroll:e$,onPaneContextMenu:ez,paneClickDistance:e_=1,nodeClickDistance:eL=0,children:eR,onReconnect:eO,onReconnectStart:eB,onReconnectEnd:eH,onEdgeContextMenu:eT,onEdgeDoubleClick:eV,onEdgeMouseEnter:eF,onEdgeMouseMove:eZ,onEdgeMouseLeave:eW,reconnectRadius:eX=10,onNodesChange:eK,onEdgesChange:eY,noDragClassName:eU="nodrag",noWheelClassName:eq="nowheel",noPanClassName:eQ="nopan",fitView:eG,fitViewOptions:eJ,connectOnClick:e0,attributionPosition:e1,proOptions:e2,defaultEdgeOptions:e3,elevateNodesOnSelect:e4=!0,elevateEdgesOnSelect:e5=!1,disableKeyboardA11y:e6=!1,autoPanOnConnect:e8,autoPanOnNodeDrag:e7,autoPanSpeed:e9,connectionRadius:te,isValidConnection:tt,onError:tn,style:to,id:tr,nodeDragThreshold:ti,connectionDragThreshold:ta,viewport:tl,onViewportChange:ts,width:td,height:tc,colorMode:tu="light",debug:th,onScroll:tf,ariaLabelConfig:tg,zIndexMode:tp="basic",...tm},tx){let ty=tr||"1",tv=function(e){let[t,n]=(0,y.useState)("system"===e?null:e);return(0,y.useEffect)(()=>{if("system"!==e)return void n(e);let t=tq(),o=()=>n(t?.matches?"dark":"light");return o(),t?.addEventListener("change",o),()=>{t?.removeEventListener("change",o)}},[e]),null!==t?t:tq()?.matches?"dark":"light"}(tu),tb=(0,y.useCallback)(e=>{e.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),tf?.(e)},[tf]);return(0,x.jsx)("div",{"data-testid":"rf__wrapper",...tm,onScroll:tb,style:{...to,...oy},ref:tx,className:v(["react-flow",r,tv]),id:tr,role:"application",children:(0,x.jsxs)(ox,{nodes:e,edges:t,width:td,height:tc,fitView:eG,fitViewOptions:eJ,minZoom:ep,maxZoom:em,nodeOrigin:ec,nodeExtent:eb,zIndexMode:tp,children:[(0,x.jsx)(og,{onInit:d,onNodeClick:l,onEdgeClick:s,onNodeMouseEnter:M,onNodeMouseMove:C,onNodeMouseLeave:N,onNodeContextMenu:k,onNodeDoubleClick:j,nodeTypes:i,edgeTypes:a,connectionLineType:W,connectionLineStyle:X,connectionLineComponent:K,connectionLineContainerStyle:Y,selectionKeyCode:q,selectionOnDrag:Q,selectionMode:G,deleteKeyCode:U,multiSelectionKeyCode:ee,panActivationKeyCode:J,zoomActivationKeyCode:et,onlyRenderVisibleElements:er,defaultViewport:eg,translateExtent:ey,minZoom:ep,maxZoom:em,preventScrolling:ev,zoomOnScroll:eS,zoomOnPinch:eE,zoomOnDoubleClick:ek,panOnScroll:eM,panOnScrollSpeed:eC,panOnScrollMode:eN,panOnDrag:ej,onPaneClick:eP,onPaneMouseEnter:eI,onPaneMouseMove:eA,onPaneMouseLeave:eD,onPaneScroll:e$,onPaneContextMenu:ez,paneClickDistance:e_,nodeClickDistance:eL,onSelectionContextMenu:H,onSelectionStart:T,onSelectionEnd:V,onReconnect:eO,onReconnectStart:eB,onReconnectEnd:eH,onEdgeContextMenu:eT,onEdgeDoubleClick:eV,onEdgeMouseEnter:eF,onEdgeMouseMove:eZ,onEdgeMouseLeave:eW,reconnectRadius:eX,defaultMarkerColor:ew,noDragClassName:eU,noWheelClassName:eq,noPanClassName:eQ,rfId:ty,disableKeyboardA11y:e6,nodeExtent:eb,viewport:tl,onViewportChange:ts}),(0,x.jsx)(tU,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:m,onConnectStart:b,onConnectEnd:w,onClickConnectStart:S,onClickConnectEnd:E,nodesDraggable:ea,autoPanOnNodeFocus:el,nodesConnectable:es,nodesFocusable:ed,edgesFocusable:eu,edgesReconnectable:eh,elementsSelectable:ef,elevateNodesOnSelect:e4,elevateEdgesOnSelect:e5,minZoom:ep,maxZoom:em,nodeExtent:eb,onNodesChange:eK,onEdgesChange:eY,snapToGrid:en,snapGrid:eo,connectionMode:Z,translateExtent:ey,connectOnClick:e0,defaultEdgeOptions:e3,fitView:eG,fitViewOptions:eJ,onNodesDelete:D,onEdgesDelete:$,onDelete:z,onNodeDragStart:P,onNodeDrag:I,onNodeDragStop:A,onSelectionDrag:O,onSelectionDragStart:L,onSelectionDragStop:B,onMove:f,onMoveStart:g,onMoveEnd:p,noPanClassName:eQ,nodeOrigin:ec,rfId:ty,autoPanOnConnect:e8,autoPanOnNodeDrag:e7,autoPanSpeed:e9,onError:tn,connectionRadius:te,isValidConnection:tt,selectNodesOnDrag:ei,nodeDragThreshold:ti,connectionDragThreshold:ta,onBeforeDelete:F,debug:th,ariaLabelConfig:tg,zIndexMode:tp}),(0,x.jsx)(tF,{onSelectionChange:_}),eR,(0,x.jsx)(tR,{proOptions:e2,position:e1}),(0,x.jsx)(t_,{rfId:ty,disableKeyboardA11y:e6})]})})});let ob=e=>e.domNode?.querySelector(".react-flow__edgelabel-renderer");function ow({children:e}){let t=tN(ob);return t?(0,tS.createPortal)(e,t):null}function oS({dimensions:e,lineWidth:t,variant:n,className:o}){return(0,x.jsx)("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:v(["react-flow__background-pattern",n,o])})}function oE({radius:e,className:t}){return(0,x.jsx)("circle",{cx:e,cy:e,r:e,className:v(["react-flow__background-pattern","dots",t])})}(s=m||(m={})).Lines="lines",s.Dots="dots",s.Cross="cross";let oM={[m.Dots]:1,[m.Lines]:1,[m.Cross]:6},oC=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function oN({id:e,variant:t=m.Dots,gap:n=20,size:o,lineWidth:r=1,offset:i=0,color:a,bgColor:l,style:s,className:d,patternClassName:c}){let u=(0,y.useRef)(null),{transform:h,patternId:f}=tN(oC,tw),g=o||oM[t],p=t===m.Dots,b=t===m.Cross,w=Array.isArray(n)?n:[n,n],S=[w[0]*h[2]||1,w[1]*h[2]||1],E=g*h[2],M=Array.isArray(i)?i:[i,i],C=b?[E,E]:S,N=[M[0]*h[2]||1+C[0]/2,M[1]*h[2]||1+C[1]/2],k=`${f}${e||""}`;return(0,x.jsxs)("svg",{className:v(["react-flow__background",d]),style:{...s,...na,"--xy-background-color-props":l,"--xy-background-pattern-color-props":a},ref:u,"data-testid":"rf__background",children:[(0,x.jsx)("pattern",{id:k,x:h[0]%S[0],y:h[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${N[0]},-${N[1]})`,children:p?(0,x.jsx)(oE,{radius:E/2,className:c}):(0,x.jsx)(oS,{dimensions:C,lineWidth:r,variant:t,className:c})}),(0,x.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${k})`})]})}oN.displayName="Background";let ok=(0,y.memo)(oN);function oj(){return(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,x.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function oP(){return(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,x.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function oI(){return(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,x.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function oA(){return(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,x.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function oD(){return(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,x.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function o$({children:e,className:t,...n}){return(0,x.jsx)("button",{type:"button",className:v(["react-flow__controls-button",t]),...n,children:e})}let oz=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function o_({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:a,onFitView:l,onInteractiveChange:s,className:d,children:c,position:u="bottom-left",orientation:h="vertical","aria-label":f}){let g=tk(),{isInteractive:p,minZoomReached:m,maxZoomReached:y,ariaLabelConfig:b}=tN(oz,tw),{zoomIn:w,zoomOut:S,fitView:E}=no();return(0,x.jsxs)(tL,{className:v(["react-flow__controls","horizontal"===h?"horizontal":"vertical",d]),position:u,style:e,"data-testid":"rf__controls","aria-label":f??b["controls.ariaLabel"],children:[t&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(o$,{onClick:()=>{w(),i?.()},className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:y,children:(0,x.jsx)(oj,{})}),(0,x.jsx)(o$,{onClick:()=>{S(),a?.()},className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:m,children:(0,x.jsx)(oP,{})})]}),n&&(0,x.jsx)(o$,{className:"react-flow__controls-fitview",onClick:()=>{E(r),l?.()},title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:(0,x.jsx)(oI,{})}),o&&(0,x.jsx)(o$,{className:"react-flow__controls-interactive",onClick:()=>{g.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),s?.(!p)},title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:p?(0,x.jsx)(oD,{}):(0,x.jsx)(oA,{})}),c]})}o_.displayName="Controls";let oL=(0,y.memo)(o_),oR=(0,y.memo)(function({id:e,x:t,y:n,width:o,height:r,style:i,color:a,strokeColor:l,strokeWidth:s,className:d,borderRadius:c,shapeRendering:u,selected:h,onClick:f}){let{background:g,backgroundColor:p}=i||{};return(0,x.jsx)("rect",{className:v(["react-flow__minimap-node",{selected:h},d]),x:t,y:n,rx:c,ry:c,width:o,height:r,style:{fill:a||g||p,stroke:l,strokeWidth:s},shapeRendering:u,onClick:f?t=>f(t,e):void 0})}),oO=e=>e.nodes.map(e=>e.id),oB=e=>e instanceof Function?e:()=>e,oH=(0,y.memo)(function({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:a,NodeComponent:l,onClick:s}){let{node:d,x:c,y:u,width:h,height:f}=tN(t=>{let{internals:n}=t.nodeLookup.get(e),o=n.userNode,{x:r,y:i}=n.positionAbsolute,{width:a,height:l}=ev(o);return{node:o,x:r,y:i,width:a,height:l}},tw);return d&&!d.hidden&&eb(d)?(0,x.jsx)(l,{x:c,y:u,width:h,height:f,style:d.style,selected:!!d.selected,className:o(d),color:t(d),borderRadius:r,strokeColor:n(d),strokeWidth:i,shapeRendering:a,onClick:s,id:d.id}):null});var oT=(0,y.memo)(function({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:i=oR,onClick:a}){let l=tN(oO,tw),s=oB(t),d=oB(e),c=oB(n),u="u"<typeof window||window.chrome?"crispEdges":"geometricPrecision";return(0,x.jsx)(x.Fragment,{children:l.map(e=>(0,x.jsx)(oH,{id:e,nodeColorFunc:s,nodeStrokeColorFunc:d,nodeClassNameFunc:c,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:i,onClick:a,shapeRendering:u},e))})});let oV=e=>!e.hidden,oF=e=>{let t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?el(X(e.nodeLookup,{filter:oV}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}};function oZ({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:a,nodeComponent:l,bgColor:s,maskColor:d,maskStrokeColor:c,maskStrokeWidth:u,position:h="bottom-right",onClick:f,onNodeClick:g,pannable:p=!1,zoomable:m=!1,ariaLabel:b,inversePan:E,zoomStep:M=1,offsetScale:C=5}){let N=tk(),k=(0,y.useRef)(null),{boundingRect:j,viewBB:P,rfId:I,panZoom:A,translateExtent:$,flowWidth:z,flowHeight:_,ariaLabelConfig:L}=tN(oF,tw),R=e?.width??200,O=e?.height??150,B=Math.max(j.width/R,j.height/O),H=B*R,T=B*O,V=C*B,F=j.x-(H-j.width)/2-V,Z=j.y-(T-j.height)/2-V,W=H+2*V,X=T+2*V,K=`react-flow__minimap-desc-${I}`,Y=(0,y.useRef)(0),U=(0,y.useRef)();Y.current=B,(0,y.useEffect)(()=>{if(k.current&&A)return U.current=function({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){let r=(0,w.select)(e);return{update:function({translateExtent:e,width:i,height:a,zoomStep:l=1,pannable:s=!0,zoomable:d=!0,inversePan:c=!1}){let u=[0,0],h=(0,D.default)().on("start",e=>{("mousedown"===e.sourceEvent.type||"touchstart"===e.sourceEvent.type)&&(u=[e.sourceEvent.clientX??e.sourceEvent.touches[0].clientX,e.sourceEvent.clientY??e.sourceEvent.touches[0].clientY])}).on("zoom",s?r=>{let l=n();if("mousemove"!==r.sourceEvent.type&&"touchmove"!==r.sourceEvent.type||!t)return;let s=[r.sourceEvent.clientX??r.sourceEvent.touches[0].clientX,r.sourceEvent.clientY??r.sourceEvent.touches[0].clientY],d=[s[0]-u[0],s[1]-u[1]];u=s;let h=o()*Math.max(l[2],Math.log(l[2]))*(c?-1:1),f={x:l[0]-d[0]*h,y:l[1]-d[1]*h};t.setViewportConstrained({x:f.x,y:f.y,zoom:l[2]},[[0,0],[i,a]],e)}:null).on("zoom.wheel",d?e=>{if("wheel"!==e.sourceEvent.type||!t)return;let o=n(),r=e.sourceEvent.ctrlKey&&ex()?10:1,i=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*l,a=o[2]*Math.pow(2,i*r);t.scaleTo(a)}:null);r.call(h,{})},destroy:function(){r.on("zoom",null)},pointer:S.pointer}}({domNode:k.current,panZoom:A,getTransform:()=>N.getState().transform,getViewScale:()=>Y.current}),()=>{U.current?.destroy()}},[A]),(0,y.useEffect)(()=>{U.current?.update({translateExtent:$,width:z,height:_,inversePan:E,pannable:p,zoomStep:M,zoomable:m})},[p,m,E,M,$,z,_]);let q=f?e=>{let[t,n]=U.current?.pointer(e)||[0,0];f(e,{x:t,y:n})}:void 0,Q=g?(0,y.useCallback)((e,t)=>{g(e,N.getState().nodeLookup.get(t).internals.userNode)},[]):void 0,G=b??L["minimap.ariaLabel"];return(0,x.jsx)(tL,{position:h,style:{...e,"--xy-minimap-background-color-props":"string"==typeof s?s:void 0,"--xy-minimap-mask-background-color-props":"string"==typeof d?d:void 0,"--xy-minimap-mask-stroke-color-props":"string"==typeof c?c:void 0,"--xy-minimap-mask-stroke-width-props":"number"==typeof u?u*B:void 0,"--xy-minimap-node-background-color-props":"string"==typeof o?o:void 0,"--xy-minimap-node-stroke-color-props":"string"==typeof n?n:void 0,"--xy-minimap-node-stroke-width-props":"number"==typeof a?a:void 0},className:v(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:(0,x.jsxs)("svg",{width:R,height:O,viewBox:`${F} ${Z} ${W} ${X}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":K,ref:k,onClick:q,children:[G&&(0,x.jsx)("title",{id:K,children:G}),(0,x.jsx)(oT,{onClick:Q,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:a,nodeComponent:l}),(0,x.jsx)("path",{className:"react-flow__minimap-mask",d:`M${F-V},${Z-V}h${W+2*V}v${X+2*V}h${-W-2*V}z
        M${P.x},${P.y}h${P.width}v${P.height}h${-P.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}oZ.displayName="MiniMap";let oW=(0,y.memo)(oZ),oX={[p.Line]:"right",[p.Handle]:"bottom-right"};(0,y.memo)(function({nodeId:e,position:t,variant:n=p.Handle,className:o,style:r,children:i,color:a,minWidth:l=10,minHeight:s=10,maxWidth:d=Number.MAX_VALUE,maxHeight:c=Number.MAX_VALUE,keepAspectRatio:u=!1,resizeDirection:h,autoScale:f=!0,shouldResize:g,onResizeStart:m,onResize:b,onResizeEnd:S}){let E,M=nv(),C="string"==typeof e?e:M,N=tk(),k=(0,y.useRef)(null),j=n===p.Handle,P=tN((0,y.useCallback)((E=j&&f,e=>E?`${Math.max(1/e.transform[2],1)}`:void 0),[j,f]),tw),I=(0,y.useRef)(null),D=t??oX[n];(0,y.useEffect)(()=>{if(k.current&&C)return I.current||(I.current=function({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){let i=(0,w.select)(e),a={controlDirection:tl("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};return{update:function({controlPosition:e,boundaries:l,keepAspectRatio:s,resizeDirection:d,onResizeStart:c,onResize:u,onResizeEnd:h,shouldResize:f}){let g,p,m,x,y={...tu},v={...th};a={boundaries:l,resizeDirection:d,keepAspectRatio:s,controlDirection:tl(e)};let b=null,w=[],S=!1,E=A().on("start",e=>{let{nodeLookup:o,transform:r,snapGrid:i,snapToGrid:a,nodeOrigin:l,paneDomNode:s}=n();if(!(g=o.get(t)))return;b=s?.getBoundingClientRect()??null;let{xSnapped:d,ySnapped:u}=eE(e.sourceEvent,{transform:r,snapGrid:i,snapToGrid:a,containerBounds:b});if(v={...y={width:g.measured.width??0,height:g.measured.height??0,x:g.position.x??0,y:g.position.y??0},pointerX:d,pointerY:u,aspectRatio:y.width/y.height},p=void 0,g.parentId&&("parent"===g.extent||g.expandParent)){var h;m=(p=o.get(g.parentId))&&"parent"===g.extent?[[0,0],[(h=p).measured.width,h.measured.height]]:void 0}for(let[e,n]of(w=[],x=void 0,o))if(n.parentId===t&&(w.push({id:e,position:{...n.position},extent:n.extent}),"parent"===n.extent||n.expandParent)){let e=function(e,t,n){let o=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,a=e.measured.height??0,l=n[0]*i,s=n[1]*a;return[[o-l,r-s],[o+i-l,r+a-s]]}(n,g,n.origin??l);x=x?[[Math.min(e[0][0],x[0][0]),Math.min(e[0][1],x[0][1])],[Math.max(e[1][0],x[1][0]),Math.max(e[1][1],x[1][1])]]:e}c?.(e,{...y})}).on("drag",e=>{let{transform:t,snapGrid:r,snapToGrid:i,nodeOrigin:l}=n(),s=eE(e.sourceEvent,{transform:t,snapGrid:r,snapToGrid:i,containerBounds:b}),d=[];if(!g)return;let{x:c,y:h,width:E,height:M}=y,C={},N=g.origin??l,{width:k,height:j,x:P,y:I}=function(e,t,n,o,r,i,a,l){var s,d,c,u;let{affectsX:h,affectsY:f}=t,{isHorizontal:g,isVertical:p}=t,m=g&&p,{xSnapped:x,ySnapped:y}=n,{minWidth:v,maxWidth:b,minHeight:w,maxHeight:S}=o,{x:E,y:M,width:C,height:N,aspectRatio:k}=e,j=Math.floor(g?x-e.pointerX:0),P=Math.floor(p?y-e.pointerY:0),I=C+(h?-j:j),A=N+(f?-P:P),D=-i[0]*C,$=-i[1]*N,z=tc(I,v,b),_=tc(A,w,S);if(a){let e=0,t=0;h&&j<0?e=ts(E+j+D,a[0][0]):!h&&j>0&&(e=td(E+I+D,a[1][0])),f&&P<0?t=ts(M+P+$,a[0][1]):!f&&P>0&&(t=td(M+A+$,a[1][1])),z=Math.max(z,e),_=Math.max(_,t)}if(l){let e=0,t=0;h&&j>0?e=td(E+j,l[0][0]):!h&&j<0&&(e=ts(E+I,l[1][0])),f&&P>0?t=td(M+P,l[0][1]):!f&&P<0&&(t=ts(M+A,l[1][1])),z=Math.max(z,e),_=Math.max(_,t)}if(r){if(g){(z=Math.max(z,tc(I/k,w,S)*k),a)&&(z=Math.max(z,(h||f)&&(!h||f||!m)?ts(M+$+(h?j:-j)/k,a[0][1])*k:td(M+$+I/k,a[1][1])*k));l&&(z=Math.max(z,(h||f)&&(!h||f||!m)?td(M+(h?j:-j)/k,l[0][1])*k:ts(M+I/k,l[1][1])*k))}if(p){(_=Math.max(_,tc(A*k,v,b)/k),a)&&(_=Math.max(_,(h||f)&&(!f||h||!m)?ts(E+(f?P:-P)*k+D,a[0][0])/k:td(E+A*k+D,a[1][0])/k));l&&(_=Math.max(_,(h||f)&&(!f||h||!m)?td(E+(f?P:-P)*k,l[0][0])/k:ts(E+A*k,l[1][0])/k))}}P+=P<0?_:-_,j+=j<0?z:-z,r&&(m?I>A*k?P=((s=h,d=f,s?!d:d)?-j:j)/k:j=((c=h,u=f,c?!u:u)?-P:P)*k:g?(P=j/k,f=h):(j=P*k,h=f));let L=h?E+j:E,R=f?M+P:M;return{width:C+(h?-j:j),height:N+(f?-P:P),x:i[0]*j*(h?-1:1)+L,y:i[1]*P*(f?-1:1)+R}}(v,a.controlDirection,s,a.boundaries,a.keepAspectRatio,N,m,x),A=k!==E,D=j!==M,$=P!==c&&A,z=I!==h&&D;if(!$&&!z&&!A&&!D)return;if(($||z||1===N[0]||1===N[1])&&(C.x=$?P:y.x,C.y=z?I:y.y,y.x=C.x,y.y=C.y,w.length>0)){let e=P-c,t=I-h;for(let n of w)n.position={x:n.position.x-e+N[0]*(k-E),y:n.position.y-t+N[1]*(j-M)},d.push(n)}if((A||D)&&(C.width=A&&(!a.resizeDirection||"horizontal"===a.resizeDirection)?k:y.width,C.height=D&&(!a.resizeDirection||"vertical"===a.resizeDirection)?j:y.height,y.width=C.width,y.height=C.height),p&&g.expandParent){let e=N[0]*(C.width??0);C.x&&C.x<e&&(y.x=e,v.x=v.x-(C.x-e));let t=N[1]*(C.height??0);C.y&&C.y<t&&(y.y=t,v.y=v.y-(C.y-t))}let _=function({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:i}){let a=e-t,l=n-o,s=[a>0?1:a<0?-1:0,l>0?1:l<0?-1:0];return a&&r&&(s[0]=-1*s[0]),l&&i&&(s[1]=-1*s[1]),s}({width:y.width,prevWidth:E,height:y.height,prevHeight:M,affectsX:a.controlDirection.affectsX,affectsY:a.controlDirection.affectsY}),L={...y,direction:_};!1!==f?.(e,L)&&(S=!0,u?.(e,L),o(C,d))}).on("end",e=>{S&&(h?.(e,{...y}),r?.({...y}),S=!1)});i.call(E)},destroy:function(){i.on(".drag",null)}}}({domNode:k.current,nodeId:C,getStoreItems:()=>{let{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:r,domNode:i}=N.getState();return{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:r,paneDomNode:i}},onChange:(e,t)=>{let{triggerNodeChanges:n,nodeLookup:o,parentLookup:r,nodeOrigin:i}=N.getState(),a=[],l={x:e.x,y:e.y},s=o.get(C);if(s&&s.expandParent&&s.parentId){let t=s.origin??i,n=e.width??s.measured.width??0,d=e.height??s.measured.height??0,c=eJ([{id:s.id,parentId:s.parentId,rect:{width:n,height:d,...ew({x:e.x??s.position.x,y:e.y??s.position.y},{width:n,height:d},s.parentId,o,t)}}],o,r,i);a.push(...c),l.x=e.x?Math.max(t[0]*n,e.x):void 0,l.y=e.y?Math.max(t[1]*d,e.y):void 0}if(void 0!==l.x&&void 0!==l.y){let e={id:C,type:"position",position:{...l}};a.push(e)}if(void 0!==e.width&&void 0!==e.height){let t={id:C,type:"dimensions",resizing:!0,setAttributes:!h||("horizontal"===h?"width":"height"),dimensions:{width:e.width,height:e.height}};a.push(t)}for(let e of t){let t={...e,type:"position"};a.push(t)}n(a)},onEnd:({width:e,height:t})=>{N.getState().triggerNodeChanges([{id:C,type:"dimensions",resizing:!1,dimensions:{width:e,height:t}}])}})),I.current.update({controlPosition:D,boundaries:{minWidth:l,minHeight:s,maxWidth:d,maxHeight:c},keepAspectRatio:u,resizeDirection:h,onResizeStart:m,onResize:b,onResizeEnd:S,shouldResize:g}),()=>{I.current?.destroy()}},[D,l,s,d,c,u,m,b,S,g]);let $=D.split("-");return(0,x.jsx)("div",{className:v(["react-flow__resize-control","nodrag",...$,n,o]),ref:k,style:{...r,scale:P,...a&&{[j?"backgroundColor":"borderColor"]:a}},children:i})});let oK={default:{bg:"#FFFFFF",border:"#E2E8F0",text:"#134E4A"},red:{bg:"#FEF2F2",border:"#FCA5A5",text:"#991B1B"},orange:{bg:"#FFF7ED",border:"#FDBA74",text:"#9A3412"},yellow:{bg:"#FEFCE8",border:"#FDE047",text:"#854D0E"},green:{bg:"#F0FDF4",border:"#86EFAC",text:"#166534"},blue:{bg:"#EFF6FF",border:"#93C5FD",text:"#1E40AF"},purple:{bg:"#FAF5FF",border:"#C4B5FD",text:"#6B21A8"},pink:{bg:"#FDF2F8",border:"#F9A8D4",text:"#9D174D"}},oY={default:"#14B8A6",core:"#DC2626",important:"#F97316",normal:"#14B8A6",minor:"#94A3B8"},oU=(0,y.memo)(function({data:e,selected:t}){let[n,o]=(0,y.useState)(!1),r=oK[e.color||"default"];return(0,x.jsxs)("div",{className:"relative",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[(0,x.jsxs)("div",{className:"px-4 py-3 rounded-xl border-2 min-w-[120px] max-w-[200px] transition-all duration-200 hover:shadow-md",style:{backgroundColor:r.bg,...t?{borderColor:"#c94043",boxShadow:"0 0 0 3px rgba(201,64,67,0.15)"}:{borderColor:r.border}},children:[(0,x.jsx)("div",{className:"font-semibold text-sm truncate text-center select-none",style:{color:r.text},children:e.label||""}),e.tags&&e.tags.length>0&&(0,x.jsx)("div",{className:"flex flex-wrap gap-1 mt-2 justify-center",children:e.tags.slice(0,3).map((e,t)=>(0,x.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded-md font-medium select-none",style:{backgroundColor:`${r.border}40`,color:r.text},children:e},t))}),e.color&&"default"!==e.color&&(0,x.jsx)("div",{className:"absolute top-1 right-1 w-2 h-2 rounded-full",style:{backgroundColor:r.border}}),e.locked&&(0,x.jsx)("div",{className:"absolute top-1 left-1 w-4 h-4 flex items-center justify-center",style:{color:"var(--color-vermilion)"},title:"",children:(0,x.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,x.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,x.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),(0,x.jsxs)("div",{className:`
          absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2
          w-8 h-8 rounded-full
          flex items-center justify-center
          transition-all duration-150
          ${n?"opacity-100 scale-100 bg-[var(--color-vermilion)]/30 border-2 border-[var(--color-vermilion)]":"opacity-0 scale-50"}
        `,children:[(0,x.jsx)("div",{className:`w-3 h-3 rounded-full bg-[var(--color-vermilion)] ${n?"animate-pulse":""}`}),(0,x.jsx)(nw,{type:"source",position:g.Right,id:"center",style:{position:"absolute",width:"100%",height:"100%",top:0,left:0,transform:"none",background:"transparent",border:"none",borderRadius:"50%"}}),(0,x.jsx)(nw,{type:"target",position:g.Left,id:"center-target",style:{position:"absolute",width:"100%",height:"100%",top:0,left:0,transform:"none",background:"transparent",border:"none",borderRadius:"50%"}})]})]})}),oq=(0,y.memo)(function({id:e,sourceX:t,sourceY:n,targetX:o,targetY:r,style:i={},selected:a,data:l}){let s=o-t,d=r-n,c=Math.min(.3*Math.sqrt(s*s+d*d),80),u=(t+o)/2,h=(n+r)/2,f=Math.abs(s)>Math.abs(d),g=f?u:u+(d>0?-c:c),p=f?h+(s>0?-c:c):h,m=`M ${t} ${n} Q ${g} ${p} ${o} ${r}`,y=(t+2*g+o)/4,v=(n+2*p+r)/4,b=l?.color||"default",w=i.stroke||oY[b]||"#14B8A6",S=a?"var(--color-vermilion)":w;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("path",{id:e,className:"react-flow__edge-path",d:m,style:{strokeWidth:a?3:2,stroke:S,fill:"none"}}),(0,x.jsx)("path",{d:m,style:{strokeWidth:20,stroke:"transparent",fill:"none"},className:"react-flow__edge-interaction"}),(0,x.jsx)("circle",{r:"3",fill:w,children:(0,x.jsx)("animateMotion",{dur:"2s",repeatCount:"indefinite",path:m})}),l?.label&&(0,x.jsx)(ow,{children:(0,x.jsx)("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${y}px, ${v}px)`,pointerEvents:"all"},className:`px-2 py-0.5 text-[10px] font-medium rounded-full transition-all duration-150
              ${a?"bg-[var(--color-vermilion)] text-white shadow-md":"bg-white text-[var(--color-gray)] border border-[var(--color-border)] hover:border-[var(--color-vermilion)] hover:text-[var(--color-vermilion)]"}
            `,children:l.label})})]})}),oQ={knowledgeNode:oU},oG={centerEdge:oq};function oJ({data:e,selectedNode:t,onNodeSelect:n,showMinimap:o=!0}){let[r,,i]=function(e){let[t,n]=(0,y.useState)(e),o=(0,y.useCallback)(e=>n(t=>t1(e,t)),[]);return[t,n,o]}(e.nodes),[a,,l]=function(e){let[t,n]=(0,y.useState)(e),o=(0,y.useCallback)(e=>n(t=>t1(e,t)),[]);return[t,n,o]}(e.edges),{fitView:s,getViewport:c,setViewport:u}=no(),h=(0,y.useRef)(null),f=(0,y.useRef)(!1),g=(0,y.useRef)(null),p=(0,y.useCallback)((e,t)=>{g.current={viewport:c(),width:h.current?.offsetWidth||0},n(t)},[n,c]),v=(0,y.useCallback)(()=>{g.current={viewport:c(),width:h.current?.offsetWidth||0},n(null)},[n,c]);(0,y.useEffect)(()=>{let e=null!==t;if(f.current!==e){let t=c(),n=h.current?.offsetWidth||0,o=g.current?.viewport||t,r=g.current?.width;r&&0!==r||(r=e?n+336:n-336);let i=setTimeout(()=>{if(r>0&&n>0){let e=n/r;u({x:o.x*e,y:o.y,zoom:o.zoom*e},{duration:300})}},50);return f.current=e,g.current=null,()=>clearTimeout(i)}},[t,c,u,336]);let b=(0,y.useCallback)(e=>oK[e.data.color||"default"].bg,[]),w=(0,y.useMemo)(()=>r.map(e=>({...e,type:"knowledgeNode"})),[r]),S=(0,y.useMemo)(()=>{let e=new Map;return r.forEach(t=>{e.set(t.id,t.data)}),e},[r]),E=(0,y.useMemo)(()=>a.map(e=>{let t=S.get(e.source),n=t?.edgeColor||"default",o=oY[n];return{...e,type:"centerEdge",data:{...e.data,label:e.label||e.data?.label,color:n},style:{stroke:o}}}),[a,S]);return(0,x.jsx)("div",{ref:h,className:"w-full h-full",children:(0,x.jsxs)(ov,{nodes:w,edges:E,onNodesChange:i,onEdgesChange:l,onNodeClick:p,onPaneClick:v,nodeTypes:oQ,edgeTypes:oG,connectionMode:d.Loose,fitView:!0,fitViewOptions:{padding:.2,maxZoom:1.5},minZoom:.1,maxZoom:2,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!0,panOnScroll:!0,selectionOnDrag:!1,className:"bg-[var(--color-paper)]",proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"centerEdge"},children:[(0,x.jsx)(ok,{variant:m.Dots,gap:16,size:1,color:"var(--color-border)"}),(0,x.jsx)(oL,{showInteractive:!1,className:"!bg-white !border-[var(--color-border)] !shadow-md"}),o&&(0,x.jsx)(oW,{nodeColor:b,nodeStrokeWidth:2,zoomable:!0,pannable:!0,className:"!bg-white !border-[var(--color-border)]"})]})})}function o0({data:e,selectedNode:t,onNodeSelect:n,showMinimap:o}){return(0,x.jsx)("div",{className:"w-full h-full",children:(0,x.jsx)(om,{children:(0,x.jsx)(oJ,{data:e,selectedNode:t,onNodeSelect:n,showMinimap:o})})})}function o1({node:e,onClose:t}){let n=e.data,o=oK[n.color||"default"];return(0,x.jsxs)("div",{className:"h-full flex flex-col bg-white border-l border-[var(--color-border)]",children:[(0,x.jsxs)("div",{className:"px-4 py-4 flex items-center justify-between shrink-0",style:{backgroundColor:o.bg},children:[(0,x.jsx)("h3",{className:"font-semibold text-lg",style:{color:o.text},children:n.label}),(0,x.jsx)("button",{onClick:t,className:"p-1.5 rounded-lg hover:bg-black/10 transition-colors",title:"",children:(0,x.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,x.jsx)("path",{d:"M4 4L12 12M12 4L4 12"})})})]}),(0,x.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[n.tags&&n.tags.length>0&&(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{className:"text-xs font-medium text-[var(--color-gray)] mb-2 uppercase tracking-wide",children:""}),(0,x.jsx)("div",{className:"flex flex-wrap gap-2",children:n.tags.map((e,t)=>(0,x.jsx)("span",{className:"text-sm px-2.5 py-1 rounded-lg",style:{backgroundColor:o.border,color:o.text},children:e},t))})]}),n.content&&(0,x.jsxs)("div",{children:[(0,x.jsx)("h4",{className:"text-xs font-medium text-[var(--color-gray)] mb-2 uppercase tracking-wide",children:""}),(0,x.jsx)("div",{className:"text-sm text-[var(--color-ink)] prose-sm leading-relaxed",dangerouslySetInnerHTML:{__html:n.content}})]}),(n.createdAt||n.updatedAt)&&(0,x.jsxs)("div",{className:"pt-4 border-t border-[var(--color-border)]",children:[(0,x.jsx)("h4",{className:"text-xs font-medium text-[var(--color-gray)] mb-2 uppercase tracking-wide",children:""}),(0,x.jsxs)("div",{className:"text-sm text-[var(--color-gray)] space-y-1",children:[n.createdAt&&(0,x.jsxs)("p",{children:["",new Date(n.createdAt).toLocaleDateString("zh-CN")]}),n.updatedAt&&(0,x.jsxs)("p",{children:["",new Date(n.updatedAt).toLocaleDateString("zh-CN")]})]})]})]})]})}function o2({data:e}){let[t,n]=(0,y.useState)(null),[o,r]=(0,y.useState)(!0);return(0,x.jsxs)("div",{className:"flex gap-4 h-[600px]",children:[(0,x.jsxs)("div",{className:"flex-1 relative rounded-lg overflow-hidden border border-[var(--color-border)]",children:[(0,x.jsx)(o0,{data:e,selectedNode:t,onNodeSelect:n,showMinimap:o}),(0,x.jsxs)("div",{className:"absolute top-4 left-4 flex flex-col gap-2 z-10",children:[(0,x.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-lg px-3 py-2 text-sm border border-[var(--color-border)] shadow-sm",children:(0,x.jsxs)("span",{className:"text-[var(--color-gray)]",children:[e.nodes.length,"   ",e.edges.length," "]})}),!t&&(0,x.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-lg px-3 py-2 text-sm border border-[var(--color-border)] shadow-sm",children:(0,x.jsx)("span",{className:"text-[var(--color-gray)]",children:""})})]}),(0,x.jsx)("button",{onClick:()=>r(!o),className:"absolute bottom-4 right-4 bg-white/90 backdrop-blur-sm rounded-lg px-3 py-2 text-sm border border-[var(--color-border)] shadow-sm z-10 hover:bg-white transition-colors",title:o?"":"",children:(0,x.jsx)("span",{className:"text-[var(--color-gray)]",children:o?"":""})})]}),t&&(0,x.jsx)("div",{className:"w-[320px] flex-shrink-0 rounded-lg overflow-hidden border border-[var(--color-border)]",children:(0,x.jsx)(o1,{node:t,onClose:()=>n(null)})})]})}e.s(["default",()=>o2],38841)}]);